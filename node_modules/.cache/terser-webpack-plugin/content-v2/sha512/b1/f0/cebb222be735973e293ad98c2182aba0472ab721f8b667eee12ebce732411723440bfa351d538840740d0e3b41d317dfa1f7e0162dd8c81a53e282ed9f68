{"code":"(this[\"webpackJsonpxstate-react-typescript-template\"]=this[\"webpackJsonpxstate-react-typescript-template\"]||[]).push([[0],{29:function(t,e,a){},40:function(t,e,a){\"use strict\";a.r(e);var n=a(26),o=a(9),i=(a(29),a(7),a(23)),s=a(11),r=a(20),c=a(2),l=a(44),p=a(43);const u=s.a.send;s.a.cancel;function d(t){return u((e=>({type:\"SPEAK\",value:t})))}const m={john:{person:\"John Appleseed\"},sarah:{person:\"Sarah Swiggity\"},daddy:{person:\"The big lad\"},\"on monday\":{day:\"Friday\"},\"on tuesday\":{day:\"Thursday\"},\"on wednesday\":{day:\"Friday\"},\"on thursday\":{day:\"Thursday\"},\"on friday\":{day:\"Friday\"},\"on saturday\":{day:\"Thursday\"},\"on sunday\":{day:\"Friday\"},\"at 8\":{time:\"8:00\"},\"at 9\":{time:\"9:00\"},\"at 10\":{time:\"10:00\"},\"at 11\":{time:\"11:00\"},\"at 12\":{time:\"12:00\"},\"at 13\":{time:\"13:00\"},\"at 14\":{time:\"14:00\"},\"at 15\":{time:\"15:00\"},\"at 16\":{time:\"16:00\"},8:{time:\"8:00\"},9:{time:\"9:00\"},10:{time:\"10:00\"},11:{time:\"11:00\"},12:{time:\"12:00\"},13:{time:\"13:00\"},14:{time:\"14:00\"},15:{time:\"15:00\"},16:{time:\"16:00\"},yes:{bool_val:!0},yeah:{bool_val:!0},ok:{bool_val:!0},sure:{bool_val:!0},ja:{bool_val:!0},no:{bool_val:!1},nope:{bool_val:!1},nein:{bool_val:!1},nej:{bool_val:!1},appointment:{initial_function:\"appt\"},\"an appointment\":{initial_function:\"appt\"},\"set up an appointment\":{initial_function:\"appt\"},\"make an appointment\":{initial_function:\"appt\"},\"to do\":{initial_function:\"todo\"},\"set up a to do\":{initial_function:\"todo\"},\"make to do\":{initial_function:\"todo\"},\"make a to do\":{initial_function:\"todo\"},timer:{initial_function:\"timer\"},\"make a timer\":{initial_function:\"timer\"},\"set a timer\":{initial_function:\"timer\"},\"set timer\":{initial_function:\"timer\"}};function y(t){return{initial:\"prompt\",states:{prompt:{entry:d(t),on:{ENDSPEECH:\"ask\"}},ask:{entry:[u(\"LISTEN\"),u(\"MAXSPEECH\",{delay:4e3,id:\"maxspeech_cancel\"})]}}}}const E=[\"stop\",\"help\"],h={initial:\"main\",id:\"init\",on:{MAXSPEECH:\".maxspeech\",RECOGNISED:[{target:\".stop\",cond:t=>\"stop\"===t.recResult},{target:\".help\",cond:t=>\"help\"===t.recResult}]},states:{main:{initial:\"clicky\",states:{hist:{type:\"history\",history:\"shallow\"},clicky:{on:{CLICK:\"begin\"}},begin:{initial:\"prompt\",id:\"welcome\",on:{RECOGNISED:{target:\"query\",actions:Object(c.b)((t=>({query:t.recResult}))),cond:t=>!E.includes(t.recResult)}},states:{prompt:Object(o.a)({},y(\"Would you like to book an appointment, set a timer or add a to do item?\"))}},query:{initial:\"rasa_query\",on:{RECOGNISED:{cond:t=>!E.includes(t.recResult),target:\".rasa_query\",actions:Object(c.b)((t=>({query:t.recResult})))},INVALID_QUERY:{target:\".invalid_query\"},VALID_QUERY:{target:\"select_task\"},HTTP_TIMEOUT:{target:\".http_timeout\"}},states:{rasa_query:Object(o.a)({},{initial:\"http_timeout\",invoke:{id:\"rasaquery\",src:(t,e)=>fetch(new Request(\"https://cors-anywhere.herokuapp.com/https://rasajacobcoles.herokuapp.com/model/parse\",{method:\"POST\",headers:{Origin:\"http://localhost:3000/\"},body:'{\"text\": \"'.concat(t.query,'\"}')})).then((t=>t.json())),onDone:[{target:\".invalid_query\",cond:(t,e)=>e.data.intent.confidence<.7},{target:\".valid_query\",actions:[Object(c.b)(((t,e)=>({snippet:e.data.intent.name}))),(t,e)=>console.log(e.data)]}],onError:{target:\"#root.dm\",actions:d(\"Sorry, there was an error. \")}},states:{http_timeout:{invoke:{src:(t,e)=>new Promise((t=>{setTimeout((()=>{t()}),3e3)}))},onDone:u(\"HTTP_TIMEOUT\")},invalid_query:{entry:u(\"INVALID_QUERY\")},valid_query:{entry:u(\"VALID_QUERY\")}}}),invalid_query:Object(o.a)({},y(\"Sorry, I don't understand, please say that again\")),http_timeout:Object(o.a)({},y(\"Sorry, the rasa server isnt responding right now. Try again.\"))}},select_task:{initial:\"select\",states:{select:{always:[{cond:t=>\"Appointment\"===t.snippet,target:\"#who\"},{cond:t=>\"TODO\"===t.snippet,target:\"#todo\"},{cond:t=>\"Timer\"===t.snippet,target:\"#timer\"},{cond:t=>!E.includes(t.recResult),target:\"prompt\"}]},prompt:{entry:d(\"Sorry, that isn't a valid answer\"),on:{ENDSPEECH:\"#welcome\"}}}},todo:{id:\"todo\",initial:\"prompt\",on:{ENDSPEECH:\"#init\"},states:{prompt:{entry:d(\"You are in the to do thing.\")}}},timer:{id:\"timer\",initial:\"prompt\",on:{ENDSPEECH:\"#init\"},states:{prompt:{entry:d(\"You are in the timer thing.\")}}},who:{id:\"who\",initial:\"prompt\",on:{RECOGNISED:[{cond:t=>\"person\"in(m[t.recResult]||{}),actions:Object(c.b)((t=>({person:m[t.recResult].person}))),target:\"day\"},{target:\".nomatch\",cond:t=>!E.includes(t.recResult)}]},states:{prompt:Object(o.a)({},y(\"Who are you meeting with?\")),nomatch:{entry:d(\"Sorry I don't know them\"),on:{ENDSPEECH:\"prompt\"}}}},day:{initial:\"prompt\",on:{RECOGNISED:[{cond:t=>\"day\"in(m[t.recResult]||{}),actions:Object(c.b)((t=>({day:m[t.recResult].day}))),target:\"whole_day_query\"},{target:\".nomatch\",cond:t=>!E.includes(t.recResult)}]},states:{prompt:{entry:u((t=>({type:\"SPEAK\",value:\"OK. \".concat(t.person,\". On which day is your meeting?\")}))),on:{ENDSPEECH:\"ask\"}},ask:{entry:[u(\"LISTEN\"),u(\"MAXSPEECH\",{delay:5e3,id:\"maxspeech_cancel\"})]},nomatch:{entry:d(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},whole_day_query:{initial:\"prompt\",on:{RECOGNISED:[{cond:t=>\"bool_val\"in(m[t.recResult]||{})&&0==m[t.recResult].bool_val,actions:Object(c.b)((t=>({bool_val:m[t.recResult].bool_val}))),target:\"meeting_time_query\"},{cond:t=>\"bool_val\"in(m[t.recResult]||{})&&1==m[t.recResult].bool_val,actions:Object(c.b)((t=>({bool_val:m[t.recResult].bool_val}))),target:\"confirm_full_day\"},{target:\".nomatch\",cond:t=>!E.includes(t.recResult)}]},states:{prompt:{entry:u((t=>({type:\"SPEAK\",value:\"Will the meeting take the whole day?\"}))),on:{ENDSPEECH:\"ask\"}},ask:{entry:[u(\"LISTEN\"),u(\"MAXSPEECH\",{delay:5e3,id:\"maxspeech_cancel\"})]},nomatch:{entry:d(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},meeting_time_query:{initial:\"prompt\",on:{RECOGNISED:[{cond:t=>\"time\"in(m[t.recResult]||{}),actions:Object(c.b)((t=>({time:m[t.recResult].time}))),target:\"confirm_day_and_time\"},{target:\".nomatch\",cond:t=>!E.includes(t.recResult)}]},states:{prompt:{entry:u((t=>({type:\"SPEAK\",value:\"What time is the meeting?\"}))),on:{ENDSPEECH:\"ask\"}},ask:{entry:[u(\"LISTEN\"),u(\"MAXSPEECH\",{delay:5e3,id:\"maxspeech_cancel\"})]},nomatch:{entry:d(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},confirm_day_and_time:{initial:\"prompt\",on:{RECOGNISED:[{cond:t=>\"bool_val\"in(m[t.recResult]||{})&&0==m[t.recResult].bool_val,actions:Object(c.b)((t=>({bool_val:m[t.recResult].bool_val}))),target:\"#init\"},{cond:t=>\"bool_val\"in(m[t.recResult]||{})&&1==m[t.recResult].bool_val,actions:Object(c.b)((t=>({bool_val:m[t.recResult].bool_val}))),target:\"finalise\"},{target:\".nomatch\",cond:t=>!E.includes(t.recResult)}]},states:{prompt:{entry:u((t=>({type:\"SPEAK\",value:\"Do you want to create an appointment with \".concat(t.person,\" on \").concat(t.day,\" at \").concat(t.time,\"?\")}))),on:{ENDSPEECH:\"ask\"}},ask:{entry:[u(\"LISTEN\"),u(\"MAXSPEECH\",{delay:5e3,id:\"maxspeech_cancel\"})]},nomatch:{entry:d(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},confirm_full_day:{initial:\"prompt\",on:{RECOGNISED:[{cond:t=>\"bool_val\"in(m[t.recResult]||{})&&0==m[t.recResult].bool_val,actions:Object(c.b)((t=>({bool_val:m[t.recResult].bool_val}))),target:\"#init\"},{cond:t=>\"bool_val\"in(m[t.recResult]||{})&&1==m[t.recResult].bool_val,actions:Object(c.b)((t=>({bool_val:m[t.recResult].bool_val}))),target:\"finalise\"},{target:\".nomatch\",cond:t=>!E.includes(t.recResult)}]},states:{prompt:{entry:u((t=>({type:\"SPEAK\",value:\"Do you want to create an appointment with \".concat(t.person,\" on \").concat(t.day,\" for the whole day?\")}))),on:{ENDSPEECH:\"ask\"}},ask:{entry:[u(\"LISTEN\"),u(\"MAXSPEECH\",{delay:5e3,id:\"maxspeech_cancel\"})]},nomatch:{entry:d(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},finalise:{entry:d(\"Your appointment has been created.\"),on:{ENDSPEECH:\"#init.main\"}},say_error:{target:\"main\",actions:d(\"Sorry, there was an error. \")}}},maxspeech:{entry:d(\"Sorry,\"),on:{ENDSPEECH:[{cond:t=>t.maxspeech_count<3,target:\"main.hist\"},{actions:Object(c.b)((t=>({maxspeech_count:0}))),target:\"#init\"}]}},stop:{entry:d(\"Ok, program stopped\"),target:\"main\"},help:{entry:d(\"I'm supposed to help you but I won't\"),target:\"main\"}}};var b=a(22),g=a(13);const _=s.a.send,S=s.a.cancel;Object(p.a)({url:\"https://statecharts.io/inspect\",iframe:!1});const O=Object(r.a)({id:\"root\",type:\"parallel\",states:{dm:Object(o.a)({},h),asrtts:{initial:\"idle\",states:{idle:{on:{LISTEN:\"recognising\",SPEAK:{target:\"speaking\",actions:Object(c.b)(((t,e)=>({ttsAgenda:e.value})))}}},recognising:{initial:\"progress\",entry:\"recStart\",exit:\"recStop\",on:{ASRRESULT:{actions:[\"recLogResult\",Object(c.b)(((t,e)=>({recResult:e.value.toLowerCase()})))],target:\".match\"},RECOGNISED:{actions:[S(\"maxspeech_cancel\"),Object(c.b)(((t,e)=>({maxspeech_count:0})))],target:\"idle\"},MAXSPEECH:[{cond:t=>t.maxspeech_count<3,target:\"idle\",actions:Object(c.b)(((t,e)=>({maxspeech_count:t.maxspeech_count+1})))},{target:\"idle\"}]},states:{progress:{},match:{entry:_(\"RECOGNISED\")}}},speaking:{entry:\"ttsStart\",on:{ENDSPEECH:\"idle\"}}}}}},{actions:{recLogResult:t=>{console.log(\"<< ASR: \"+t.recResult)},test:()=>{console.log(\"test\")},logIntent:t=>{console.log(\"<< NLU intent: \"+t.nluData.intent.name)}}}),R=t=>{switch(!0){case t.state.matches({asrtts:\"recognising\"}):return Object(g.jsx)(\"button\",Object(o.a)(Object(o.a)({type:\"button\",className:\"glow-on-hover\",style:{animation:\"glowing 20s linear\"}},t),{},{children:\"Listening...\"}));case t.state.matches({asrtts:\"speaking\"}):return Object(g.jsx)(\"button\",Object(o.a)(Object(o.a)({type:\"button\",className:\"glow-on-hover\",style:{animation:\"bordering 1s infinite\"}},t),{},{children:\"Speaking...\"}));default:return Object(g.jsx)(\"button\",Object(o.a)(Object(o.a)({type:\"button\",className:\"glow-on-hover\"},t),{},{children:\"Click to start\"}))}};function v(){const t=Object(b.useSpeechSynthesis)({onEnd:()=>{u(\"ENDSPEECH\")}}),e=t.speak,a=t.cancel,o=(t.speaking,Object(b.useSpeechRecognition)({onResult:t=>{u({type:\"ASRRESULT\",value:t})}})),i=o.listen,s=(o.listening,o.stop),r=Object(l.b)(O,{devTools:!0,actions:{recStart:Object(l.a)((()=>{console.log(\"LETS GOOOOOO\"),i({interimResults:!1,continuous:!0})})),recStop:Object(l.a)((()=>{console.log(\"Recognition stopped.\"),s()})),changeColour:Object(l.a)((t=>{console.log(\"Repainting...\"),document.body.style.background=t.recResult})),ttsStart:Object(l.a)(((t,a)=>{console.log(\"Speaking...\"),e({text:t.ttsAgenda})})),ttsCancel:Object(l.a)(((t,e)=>{console.log(\"TTS STOP...\"),a()}))}}),c=Object(n.a)(r,3),p=c[0],u=c[1];c[2];return Object(g.jsx)(\"div\",{className:\"App\",children:Object(g.jsx)(R,{state:p,onClick:()=>u(\"CLICK\")})})}const j=document.getElementById(\"root\");i.render(Object(g.jsx)(v,{}),j)}},[[40,1,2]]]);","name":"static/js/main.2d1e1aad.chunk.js","map":{"version":3,"sources":["static/js/main.2d1e1aad.chunk.js"],"names":["this","push","29","module","exports","__webpack_require__","40","__webpack_exports__","r","slicedToArray","objectSpread2","react_dom","es","Machine","actions","useMachine","browser","dmAppointmentUpdated_send","send","cancel","say","text","_context","type","value","grammar","john","person","sarah","daddy","on monday","day","on tuesday","on wednesday","on thursday","on friday","on saturday","on sunday","at 8","time","at 9","at 10","at 11","at 12","at 13","at 14","at 15","at 16","8","9","10","11","12","13","14","15","16","yes","bool_val","yeah","ok","sure","ja","no","nope","nein","nej","appointment","initial_function","an appointment","set up an appointment","make an appointment","to do","set up a to do","make to do","make a to do","timer","make a timer","set a timer","set timer","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","delay","id","commands","dmMachine","MAXSPEECH","RECOGNISED","target","cond","context","recResult","main","hist","history","clicky","CLICK","begin","Object","query","includes","INVALID_QUERY","VALID_QUERY","HTTP_TIMEOUT","rasa_query","invoke","src","event","fetch","Request","proxyurl","method","headers","Origin","body","concat","then","data","json","onDone","intent","confidence","snippet","name","console","log","onError","http_timeout","Promise","resolve","setTimeout","invalid_query","valid_query","select_task","select","always","todo","who","nomatch","whole_day_query","meeting_time_query","confirm_day_and_time","confirm_full_day","finalise","say_error","maxspeech","maxspeech_count","stop","help","dist","jsx_runtime","src_send","src_cancel","url","iframe","machine","dm","asrtts","idle","LISTEN","SPEAK","ttsAgenda","recognising","exit","ASRRESULT","toLowerCase","progress","match","speaking","recLogResult","test","logIntent","nluData","ReactiveButton","props","state","matches","className","style","animation","children","App","_useSpeechSynthesis","onEnd","speak","_useSpeechRecognition","onResult","result","listen","listening","_useMachine","devTools","recStart","interimResults","continuous","recStop","changeColour","document","background","ttsStart","effect","ttsCancel","_useMachine2","current","onClick","rootElement","getElementById"],"mappings":"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"},"input":"(this[\"webpackJsonpxstate-react-typescript-template\"] = this[\"webpackJsonpxstate-react-typescript-template\"] || []).push([[0],{\n\n/***/ 29:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 40:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 5 modules\nvar slicedToArray = __webpack_require__(26);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js + 1 modules\nvar objectSpread2 = __webpack_require__(9);\n\n// EXTERNAL MODULE: ./src/styles.scss\nvar styles = __webpack_require__(29);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(7);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(23);\n\n// EXTERNAL MODULE: ./node_modules/xstate/es/index.js\nvar es = __webpack_require__(11);\n\n// EXTERNAL MODULE: ./node_modules/xstate/es/Machine.js\nvar Machine = __webpack_require__(20);\n\n// EXTERNAL MODULE: ./node_modules/xstate/es/actions.js\nvar actions = __webpack_require__(2);\n\n// EXTERNAL MODULE: ./node_modules/@xstate/react/es/useMachine.js + 3 modules\nvar useMachine = __webpack_require__(44);\n\n// EXTERNAL MODULE: ./node_modules/@xstate/inspect/es/browser.js + 3 modules\nvar browser = __webpack_require__(43);\n\n// CONCATENATED MODULE: ./src/dmAppointmentUpdated.ts\nconst dmAppointmentUpdated_send=es[\"a\" /* actions */].send,dmAppointmentUpdated_cancel=es[\"a\" /* actions */].cancel;function say(text){return dmAppointmentUpdated_send(_context=>({type:\"SPEAK\",value:text}));}function dmAppointmentUpdated_listen(){return dmAppointmentUpdated_send('LISTEN');}const grammar={\"john\":{person:\"John Appleseed\"},\"sarah\":{person:\"Sarah Swiggity\"},\"daddy\":{person:\"The big lad\"},\"on monday\":{day:\"Friday\"},\"on tuesday\":{day:\"Thursday\"},\"on wednesday\":{day:\"Friday\"},\"on thursday\":{day:\"Thursday\"},\"on friday\":{day:\"Friday\"},\"on saturday\":{day:\"Thursday\"},\"on sunday\":{day:\"Friday\"},\"at 8\":{time:\"8:00\"},\"at 9\":{time:\"9:00\"},\"at 10\":{time:\"10:00\"},\"at 11\":{time:\"11:00\"},\"at 12\":{time:\"12:00\"},\"at 13\":{time:\"13:00\"},\"at 14\":{time:\"14:00\"},\"at 15\":{time:\"15:00\"},\"at 16\":{time:\"16:00\"},\"8\":{time:\"8:00\"},\"9\":{time:\"9:00\"},\"10\":{time:\"10:00\"},\"11\":{time:\"11:00\"},\"12\":{time:\"12:00\"},\"13\":{time:\"13:00\"},\"14\":{time:\"14:00\"},\"15\":{time:\"15:00\"},\"16\":{time:\"16:00\"},\"yes\":{bool_val:true},\"yeah\":{bool_val:true},\"ok\":{bool_val:true},\"sure\":{bool_val:true},\"ja\":{bool_val:true},\"no\":{bool_val:false},\"nope\":{bool_val:false},\"nein\":{bool_val:false},\"nej\":{bool_val:false},\"appointment\":{initial_function:\"appt\"},\"an appointment\":{initial_function:\"appt\"},\"set up an appointment\":{initial_function:\"appt\"},\"make an appointment\":{initial_function:\"appt\"},\"to do\":{initial_function:\"todo\"},\"set up a to do\":{initial_function:\"todo\"},\"make to do\":{initial_function:\"todo\"},\"make a to do\":{initial_function:\"todo\"},\"timer\":{initial_function:\"timer\"},\"make a timer\":{initial_function:\"timer\"},\"set a timer\":{initial_function:\"timer\"},\"set timer\":{initial_function:\"timer\"}};function promptAndAsk(prompt){return{initial:'prompt',states:{prompt:{entry:say(prompt),on:{ENDSPEECH:'ask'}},ask:{entry:[dmAppointmentUpdated_send('LISTEN'),dmAppointmentUpdated_send('MAXSPEECH',{delay:4000,id:'maxspeech_cancel'})]}}};}const proxyurl=\"https://cors-anywhere.herokuapp.com/\";// can try instead \"https://boiling-depths-26621.herokuapp.com/\"\nconst rasaurl='https://rasajacobcoles.herokuapp.com/model/parse';function nluRequest(){return{initial:'http_timeout',invoke:{id:\"rasaquery\",src:(context,event)=>{return fetch(new Request(proxyurl+rasaurl,{method:'POST',headers:{'Origin':'http://localhost:3000/'},// only required with proxy\nbody:\"{\\\"text\\\": \\\"\".concat(context.query,\"\\\"}\")})).then(data=>data.json());},onDone:[{target:'.invalid_query',cond:(context,event)=>{return event.data.intent.confidence<0.7;}},{target:'.valid_query',actions:[Object(actions[\"b\" /* assign */])((context,event)=>{return{snippet:event.data.intent.name};}),(context,event)=>console.log(event.data)]}],onError:{target:'#root.dm',actions:say(\"Sorry, there was an error. \")}},states:{http_timeout:{invoke:{src:(context,event)=>{return new Promise(resolve=>{setTimeout(()=>{resolve();},3000);});}},onDone:dmAppointmentUpdated_send('HTTP_TIMEOUT')},invalid_query:{entry:dmAppointmentUpdated_send('INVALID_QUERY')},valid_query:{entry:dmAppointmentUpdated_send('VALID_QUERY')}}};}const commands=['stop','help'];const dmMachine={initial:'main',id:'init',on:{MAXSPEECH:'.maxspeech',RECOGNISED:[{target:\".stop\",cond:context=>context.recResult==='stop'},{target:\".help\",cond:context=>context.recResult==='help'}]},states:{main:{initial:'clicky',states:{hist:{type:'history',history:'shallow'},clicky:{on:{CLICK:'begin'}},begin:{initial:\"prompt\",id:\"welcome\",on:{RECOGNISED:{target:\"query\",actions:Object(actions[\"b\" /* assign */])(context=>{return{query:context.recResult};}),cond:context=>!commands.includes(context.recResult)}},states:{prompt:Object(objectSpread2[\"a\" /* default */])({},promptAndAsk(\"Would you like to book an appointment, set a timer or add a to do item?\"))}},query:{initial:'rasa_query',on:{RECOGNISED:{cond:context=>!commands.includes(context.recResult),target:'.rasa_query',actions:Object(actions[\"b\" /* assign */])(context=>{return{query:context.recResult};})},INVALID_QUERY:{target:'.invalid_query'},VALID_QUERY:{target:'select_task'},HTTP_TIMEOUT:{target:'.http_timeout'}},states:{rasa_query:Object(objectSpread2[\"a\" /* default */])({},nluRequest()),invalid_query:Object(objectSpread2[\"a\" /* default */])({},promptAndAsk(\"Sorry, I don't understand, please say that again\")),http_timeout:Object(objectSpread2[\"a\" /* default */])({},promptAndAsk(\"Sorry, the rasa server isnt responding right now. Try again.\"))}},select_task:{initial:\"select\",states:{select:{always:[{cond:context=>context.snippet===\"Appointment\",target:\"#who\"},{cond:context=>context.snippet===\"TODO\",target:\"#todo\"},{cond:context=>context.snippet===\"Timer\",target:\"#timer\"},{cond:context=>!commands.includes(context.recResult),target:\"prompt\"}]},prompt:{entry:say(\"Sorry, that isn't a valid answer\"),on:{ENDSPEECH:\"#welcome\"}}}},todo:{id:\"todo\",initial:\"prompt\",on:{ENDSPEECH:\"#init\"},states:{prompt:{entry:say(\"You are in the to do thing.\")}}},timer:{id:\"timer\",initial:\"prompt\",on:{ENDSPEECH:\"#init\"},states:{prompt:{entry:say(\"You are in the timer thing.\")}}},who:{id:\"who\",initial:\"prompt\",on:{RECOGNISED:[{cond:context=>\"person\"in(grammar[context.recResult]||{}),actions:Object(actions[\"b\" /* assign */])(context=>{return{person:grammar[context.recResult].person};}),target:\"day\"},{target:\".nomatch\",cond:context=>!commands.includes(context.recResult)}]},states:{prompt:Object(objectSpread2[\"a\" /* default */])({},promptAndAsk(\"Who are you meeting with?\")),nomatch:{entry:say(\"Sorry I don't know them\"),on:{ENDSPEECH:\"prompt\"}}}},day:{initial:\"prompt\",on:{RECOGNISED:[{cond:context=>\"day\"in(grammar[context.recResult]||{}),actions:Object(actions[\"b\" /* assign */])(context=>{return{day:grammar[context.recResult].day};}),target:\"whole_day_query\"},{target:\".nomatch\",cond:context=>!commands.includes(context.recResult)}]},states:{prompt:{entry:dmAppointmentUpdated_send(context=>({type:\"SPEAK\",value:\"OK. \".concat(context.person,\". On which day is your meeting?\")})),on:{ENDSPEECH:\"ask\"}},ask:{entry:[dmAppointmentUpdated_send('LISTEN'),dmAppointmentUpdated_send('MAXSPEECH',{delay:5000,id:'maxspeech_cancel'})]},nomatch:{entry:say(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},whole_day_query:{initial:\"prompt\",on:{RECOGNISED:[{cond:context=>\"bool_val\"in(grammar[context.recResult]||{})&&grammar[context.recResult].bool_val==false,actions:Object(actions[\"b\" /* assign */])(context=>{return{bool_val:grammar[context.recResult].bool_val};}),target:\"meeting_time_query\"},{cond:context=>\"bool_val\"in(grammar[context.recResult]||{})&&grammar[context.recResult].bool_val==true,actions:Object(actions[\"b\" /* assign */])(context=>{return{bool_val:grammar[context.recResult].bool_val};}),target:\"confirm_full_day\"},{target:\".nomatch\",cond:context=>!commands.includes(context.recResult)}]},states:{prompt:{entry:dmAppointmentUpdated_send(context=>({type:\"SPEAK\",value:\"Will the meeting take the whole day?\"})),on:{ENDSPEECH:\"ask\"}},ask:{entry:[dmAppointmentUpdated_send('LISTEN'),dmAppointmentUpdated_send('MAXSPEECH',{delay:5000,id:'maxspeech_cancel'})]},nomatch:{entry:say(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},meeting_time_query:{initial:\"prompt\",on:{RECOGNISED:[{cond:context=>\"time\"in(grammar[context.recResult]||{}),actions:Object(actions[\"b\" /* assign */])(context=>{return{time:grammar[context.recResult].time};}),target:\"confirm_day_and_time\"},{target:\".nomatch\",cond:context=>!commands.includes(context.recResult)}]},states:{prompt:{entry:dmAppointmentUpdated_send(context=>({type:\"SPEAK\",value:\"What time is the meeting?\"})),on:{ENDSPEECH:\"ask\"}},ask:{entry:[dmAppointmentUpdated_send('LISTEN'),dmAppointmentUpdated_send('MAXSPEECH',{delay:5000,id:'maxspeech_cancel'})]},nomatch:{entry:say(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},confirm_day_and_time:{initial:\"prompt\",on:{RECOGNISED:[{cond:context=>\"bool_val\"in(grammar[context.recResult]||{})&&grammar[context.recResult].bool_val==false,actions:Object(actions[\"b\" /* assign */])(context=>{return{bool_val:grammar[context.recResult].bool_val};}),target:\"#init\"},{cond:context=>\"bool_val\"in(grammar[context.recResult]||{})&&grammar[context.recResult].bool_val==true,actions:Object(actions[\"b\" /* assign */])(context=>{return{bool_val:grammar[context.recResult].bool_val};}),target:\"finalise\"},{target:\".nomatch\",cond:context=>!commands.includes(context.recResult)}]},states:{prompt:{entry:dmAppointmentUpdated_send(context=>({type:\"SPEAK\",value:\"Do you want to create an appointment with \".concat(context.person,\" on \").concat(context.day,\" at \").concat(context.time,\"?\")})),on:{ENDSPEECH:\"ask\"}},ask:{entry:[dmAppointmentUpdated_send('LISTEN'),dmAppointmentUpdated_send('MAXSPEECH',{delay:5000,id:'maxspeech_cancel'})]},nomatch:{entry:say(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},confirm_full_day:{initial:\"prompt\",on:{RECOGNISED:[{cond:context=>\"bool_val\"in(grammar[context.recResult]||{})&&grammar[context.recResult].bool_val==false,actions:Object(actions[\"b\" /* assign */])(context=>{return{bool_val:grammar[context.recResult].bool_val};}),target:\"#init\"},{cond:context=>\"bool_val\"in(grammar[context.recResult]||{})&&grammar[context.recResult].bool_val==true,actions:Object(actions[\"b\" /* assign */])(context=>{return{bool_val:grammar[context.recResult].bool_val};}),target:\"finalise\"},{target:\".nomatch\",cond:context=>!commands.includes(context.recResult)}]},states:{prompt:{entry:dmAppointmentUpdated_send(context=>({type:\"SPEAK\",value:\"Do you want to create an appointment with \".concat(context.person,\" on \").concat(context.day,\" for the whole day?\")})),on:{ENDSPEECH:\"ask\"}},ask:{entry:[dmAppointmentUpdated_send('LISTEN'),dmAppointmentUpdated_send('MAXSPEECH',{delay:5000,id:'maxspeech_cancel'})]},nomatch:{entry:say(\"Can you please repeat that\"),on:{ENDSPEECH:\"ask\"}}}},finalise:{entry:say(\"Your appointment has been created.\"),on:{ENDSPEECH:\"#init.main\"}},say_error:{target:'main',actions:say(\"Sorry, there was an error. \")}}},maxspeech:{entry:say(\"Sorry,\"),on:{ENDSPEECH:[{cond:context=>context.maxspeech_count<3,target:'main.hist'},{actions:Object(actions[\"b\" /* assign */])(context=>{return{maxspeech_count:0};}),target:'#init'}]}},stop:{entry:say(\"Ok, program stopped\"),target:'main'},help:{entry:say(\"I'm supposed to help you but I won't\"),target:'main'}}};\n// EXTERNAL MODULE: ./node_modules/react-speech-kit/dist/index.js\nvar dist = __webpack_require__(22);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(13);\n\n// CONCATENATED MODULE: ./src/index.tsx\nconst src_send=es[\"a\" /* actions */].send,src_cancel=es[\"a\" /* actions */].cancel;Object(browser[\"a\" /* inspect */])({url:\"https://statecharts.io/inspect\",iframe:false});const machine=Object(Machine[\"a\" /* Machine */])({id:'root',type:'parallel',states:{dm:Object(objectSpread2[\"a\" /* default */])({},dmMachine),asrtts:{initial:'idle',states:{idle:{on:{LISTEN:'recognising',SPEAK:{target:'speaking',actions:Object(actions[\"b\" /* assign */])((_context,event)=>{return{ttsAgenda:event.value};})}}},recognising:{initial:'progress',entry:'recStart',exit:'recStop',on:{ASRRESULT:{actions:['recLogResult',Object(actions[\"b\" /* assign */])((_context,event)=>{return{recResult:event.value.toLowerCase()};})],target:'.match'},RECOGNISED:{actions:[src_cancel('maxspeech_cancel'),Object(actions[\"b\" /* assign */])((_context,event)=>{return{maxspeech_count:0};})],target:'idle'},MAXSPEECH:[{cond:context=>context.maxspeech_count<3,target:'idle',actions:Object(actions[\"b\" /* assign */])((_context,event)=>{return{maxspeech_count:_context.maxspeech_count+1};})},{target:'idle'}]},states:{progress:{},match:{entry:src_send('RECOGNISED')}}},speaking:{entry:'ttsStart',on:{ENDSPEECH:'idle'}}}}}},{actions:{recLogResult:context=>{/* context.recResult = event.recResult; */console.log('<< ASR: '+context.recResult);},test:()=>{console.log('test');},logIntent:context=>{/* context.nluData = event.data */console.log('<< NLU intent: '+context.nluData.intent.name);}}});const ReactiveButton=props=>{switch(true){case props.state.matches({asrtts:'recognising'}):return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\",style:{animation:\"glowing 20s linear\"}},props),{},{children:\"Listening...\"}));case props.state.matches({asrtts:'speaking'}):return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\",style:{animation:\"bordering 1s infinite\"}},props),{},{children:\"Speaking...\"}));default:return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({type:\"button\",className:\"glow-on-hover\"},props),{},{children:\"Click to start\"}));}};function App(){const _useSpeechSynthesis=Object(dist[\"useSpeechSynthesis\"])({onEnd:()=>{send('ENDSPEECH');}}),speak=_useSpeechSynthesis.speak,cancel=_useSpeechSynthesis.cancel,speaking=_useSpeechSynthesis.speaking;const _useSpeechRecognition=Object(dist[\"useSpeechRecognition\"])({onResult:result=>{send({type:\"ASRRESULT\",value:result});}}),listen=_useSpeechRecognition.listen,listening=_useSpeechRecognition.listening,stop=_useSpeechRecognition.stop;const _useMachine=Object(useMachine[\"b\" /* useMachine */])(machine,{devTools:true,actions:{recStart:Object(useMachine[\"a\" /* asEffect */])(()=>{console.log('LETS GOOOOOO');listen({interimResults:false,continuous:true});}),recStop:Object(useMachine[\"a\" /* asEffect */])(()=>{console.log('Recognition stopped.');stop();}),changeColour:Object(useMachine[\"a\" /* asEffect */])(context=>{console.log('Repainting...');document.body.style.background=context.recResult;}),ttsStart:Object(useMachine[\"a\" /* asEffect */])((context,effect)=>{console.log('Speaking...');speak({text:context.ttsAgenda});}),ttsCancel:Object(useMachine[\"a\" /* asEffect */])((context,effect)=>{console.log('TTS STOP...');cancel();})/* speak: asEffect((context) => {\n\t     * console.log('Speaking...');\n             *     speak({text: context.ttsAgenda })\n             * } */}}),_useMachine2=Object(slicedToArray[\"a\" /* default */])(_useMachine,3),current=_useMachine2[0],send=_useMachine2[1],service=_useMachine2[2];return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"App\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ReactiveButton,{state:current,onClick:()=>send('CLICK')})});};//RASA\nconst src_proxyurl=\"https://cors-anywhere.herokuapp.com/\";const src_rasaurl='https://rasajacobcoles.herokuapp.com/model/parse';const src_nluRequest=text=>fetch(new Request(src_proxyurl+src_rasaurl,{method:'POST',headers:{'Origin':'http://maraev.me'},// only required with proxy\nbody:\"{\\\"text\\\": \\\"\".concat(text,\"\\\"}\")})).then(data=>data.json());const rootElement=document.getElementById(\"root\");react_dom[\"render\"](/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(App,{}),rootElement);\n\n/***/ })\n\n},[[40,1,2]]]);","inputSourceMap":{"version":3,"sources":["/Users/jacobcoles/Desktop/LT2216/Lab2and4/react-xstate-colourchanger/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-6-0!/Users/jacobcoles/Desktop/LT2216/Lab2and4/react-xstate-colourchanger/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-6-1!/Users/jacobcoles/Desktop/LT2216/Lab2and4/react-xstate-colourchanger/node_modules/postcss-loader/src/index.js??postcss!/Users/jacobcoles/Desktop/LT2216/Lab2and4/react-xstate-colourchanger/node_modules/resolve-url-loader/index.js??ref--5-oneOf-6-3!/Users/jacobcoles/Desktop/LT2216/Lab2and4/react-xstate-colourchanger/node_modules/sass-loader/dist/cjs.js??ref--5-oneOf-6-4!/Users/jacobcoles/Desktop/LT2216/Lab2and4/react-xstate-colourchanger/src/styles.scss","/Users/jacobcoles/Desktop/LT2216/Lab2and4/react-xstate-colourchanger/src/dmAppointmentUpdated.ts","/Users/jacobcoles/Desktop/LT2216/Lab2and4/react-xstate-colourchanger/src/index.tsx"],"names":["send","actions","cancel","say","text","_context","type","value","listen","grammar","person","day","time","bool_val","initial_function","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","delay","id","proxyurl","rasaurl","nluRequest","invoke","src","context","event","fetch","Request","method","headers","body","query","then","data","json","onDone","target","cond","intent","confidence","assign","snippet","name","console","log","onError","http_timeout","Promise","resolve","setTimeout","invalid_query","valid_query","commands","dmMachine","MAXSPEECH","RECOGNISED","recResult","main","hist","history","clicky","CLICK","begin","includes","INVALID_QUERY","VALID_QUERY","HTTP_TIMEOUT","rasa_query","select_task","select","always","todo","timer","who","nomatch","whole_day_query","meeting_time_query","confirm_day_and_time","confirm_full_day","finalise","say_error","maxspeech","maxspeech_count","stop","help","inspect","url","iframe","machine","Machine","dm","asrtts","idle","LISTEN","SPEAK","ttsAgenda","recognising","exit","ASRRESULT","toLowerCase","progress","match","speaking","recLogResult","test","logIntent","nluData","ReactiveButton","props","state","matches","animation","App","useSpeechSynthesis","onEnd","speak","useSpeechRecognition","onResult","result","listening","useMachine","devTools","recStart","asEffect","interimResults","continuous","recStop","changeColour","document","style","background","ttsStart","effect","ttsCancel","current","service","rootElement","getElementById","ReactDOM"],"mappings":"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","file":"x","sourcesContent":["// extracted by mini-css-extract-plugin","import { MachineConfig, actions, Action, assign } from \"xstate\";\nconst { send, cancel } = actions;\n\n\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction listen(): Action<SDSContext, SDSEvent> {\n    return send('LISTEN')\n}\n\nconst grammar: { [index: string]: { person?: string, day?: string, time?: string, bool_val?: boolean, initial_function: string } } = {\n    \"john\": { person: \"John Appleseed\" },\n    \"sarah\": { person: \"Sarah Swiggity\" },\n    \"daddy\": { person: \"The big lad\" },\n    \"on monday\": { day: \"Friday\" },\n    \"on tuesday\": { day: \"Thursday\" },\n    \"on wednesday\": { day: \"Friday\" },\n    \"on thursday\": { day: \"Thursday\" },\n    \"on friday\": { day: \"Friday\" },\n    \"on saturday\": { day: \"Thursday\" },\n    \"on sunday\": { day: \"Friday\" },\n    \"at 8\": { time: \"8:00\" },\n    \"at 9\": { time: \"9:00\" },\n    \"at 10\": { time: \"10:00\" },\n    \"at 11\": { time: \"11:00\" },\n    \"at 12\": { time: \"12:00\" },\n    \"at 13\": { time: \"13:00\" },\n    \"at 14\": { time: \"14:00\" },\n    \"at 15\": { time: \"15:00\" },\n    \"at 16\": { time: \"16:00\" },\n    \"8\": { time: \"8:00\" },\n    \"9\": { time: \"9:00\" },\n    \"10\": { time: \"10:00\" },\n    \"11\": { time: \"11:00\" },\n    \"12\": { time: \"12:00\" },\n    \"13\": { time: \"13:00\" },\n    \"14\": { time: \"14:00\" },\n    \"15\": { time: \"15:00\" },\n    \"16\": { time: \"16:00\" },\n    \"yes\": { bool_val: true },\n\t\"yeah\": { bool_val: true },\n\t\"ok\": { bool_val: true },\n\t\"sure\": { bool_val: true },\n\t\"ja\": { bool_val: true },\n    \"no\": { bool_val: false },\n\t\"nope\": { bool_val: false },\n\t\"nein\": { bool_val: false },\n\t\"nej\": { bool_val: false },\n\t\"appointment\": { initial_function: \"appt\" },\n\t\"an appointment\": { initial_function: \"appt\" },\n\t\"set up an appointment\": { initial_function: \"appt\" },\n\t\"make an appointment\": { initial_function: \"appt\" },\n\t\"to do\": { initial_function: \"todo\" },\n\t\"set up a to do\": { initial_function: \"todo\" },\n\t\"make to do\": { initial_function: \"todo\" },\n\t\"make a to do\": { initial_function: \"todo\" },\n\t\"timer\": { initial_function: \"timer\" },\n\t\"make a timer\": { initial_function: \"timer\" },\n\t\"set a timer\": { initial_function: \"timer\" },\n\t\"set timer\": { initial_function: \"timer\" },\n}\n\nfunction promptAndAsk(prompt: string): MachineConfig<SDSContext, any, SDSEvent> {\n\t\n    return ({\n        initial: 'prompt',\n        states: {\n            prompt: {\n                entry: say(prompt),\n                on: { ENDSPEECH: 'ask' }\n            },\n            ask: {\n                entry: [\n\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\tsend( 'MAXSPEECH', { delay: 4000, id: 'maxspeech_cancel' } )\n\t\t\t\t]\n            },\n        }\n    })\n}\n\nconst proxyurl = \"https://cors-anywhere.herokuapp.com/\" // can try instead \"https://boiling-depths-26621.herokuapp.com/\"\nconst rasaurl = 'https://rasajacobcoles.herokuapp.com/model/parse'\nfunction nluRequest(): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n\t\tinitial: 'http_timeout',\n\t\tinvoke: {\n\t\t\tid: \"rasaquery\",\n\t\t\tsrc: (context, event) => {\n\t\t\t\t\n\t\t\t\treturn fetch(new Request(proxyurl + rasaurl, {\n\t\t        method: 'POST',\n\t\t        headers: { 'Origin': 'http://localhost:3000/' }, // only required with proxy\n\t\t        body: `{\"text\": \"${context.query}\"}`\n\t\t\t\t}))\n\t\t        .then(data => data.json());\n\n\t\t\t},\n\t\t\tonDone: [\n\t\t\t\t{\n\t\t\t\t\ttarget: '.invalid_query',\n\t\t\t\t\tcond: (context, event)=> { return ((event.data.intent.confidence) < 0.7) }\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttarget: '.valid_query',\n                    actions: [\n\t\t\t\t\t\tassign((context, event) => { return {snippet: event.data.intent.name }}),\n\t\t\t\t\t\t(context:SDSContext, event:any) => console.log(event.data),\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t],\n\t\t\tonError: {\n\t\t\t\t\ttarget: '#root.dm',\n\t\t\t\t\tactions: say(\"Sorry, there was an error. \")\n\t\t\t\t},\n\t\t},\n\t\tstates: {\n\t\t\thttp_timeout: {\n\t\t\t\tinvoke: {\n\t\t\t\t\tsrc: (context, event) => {\n\t\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\t\t\tsetTimeout(() => { resolve() }, 3000) \n\t\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tonDone: send('HTTP_TIMEOUT')\n\t\t\t},\n\t\t\tinvalid_query: {\n\t\t\t\tentry: send('INVALID_QUERY'),\n\t\t\t},\n\t\t\tvalid_query: {\n\t\t\t\tentry: send('VALID_QUERY'),\n\t\t\t},\n\t\t},\n\t})\n}\n\nconst commands = ['stop', 'help']\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'main',\n    id: 'init',\n    on: {\n\t\tMAXSPEECH: '.maxspeech',\n\t\tRECOGNISED: \n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\ttarget: \".stop\",\n\t\t\t\t\tcond: (context) => context.recResult === 'stop' ,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttarget: \".help\",\n\t\t\t\t\tcond: (context) => context.recResult === 'help' ,\n\t\t\t\t}\n\t\t\t],\n\t},\n    states: {\n        main: {\n\t\t\tinitial: 'clicky',\n\t\t\tstates: {\n\t\t\t\thist: { \n\t\t\t\t\ttype: 'history',\n\t\t\t\t\thistory: 'shallow',\n\t\t\t\t },\n\t\t\t\tclicky: {\n\t\t\t\t\ton: {\n\t\t\t\t\t\tCLICK: 'begin'\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbegin:{\n\t\t\t\t\tinitial: \"prompt\",\n\t\t\t\t\tid: \"welcome\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tRECOGNISED: {\n\t\t\t\t\t\t\ttarget: \"query\",\n\t\t\t\t\t\t\tactions: assign((context) => { return { query: context.recResult } }),\n\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tprompt: {\n\t\t\t\t\t\t\t...promptAndAsk(\"Would you like to book an appointment, set a timer or add a to do item?\")\n\t\t\t\t\t\t}\n\t\t            }\n\t\t\t\t},\n\t\t\t\tquery: {\n\t\t\t\t\tinitial:'rasa_query',\n\t\t\t\t\ton: {\n\t\t\t\t\t\tRECOGNISED: {\n\t\t\t\t\t\t\tcond: (context)=> !commands.includes(context.recResult),\n\t\t\t\t\t\t\ttarget: '.rasa_query',\n\t\t\t\t\t\t\tactions: assign((context) => { return { query: context.recResult } })\n\t\t\t\t\t\t},\n\t\t\t\t\t\tINVALID_QUERY: {\n\t\t\t\t\t\t\ttarget: '.invalid_query'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tVALID_QUERY: {\n\t\t\t\t\t\t\ttarget: 'select_task'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tHTTP_TIMEOUT: {\n\t\t\t\t\t\t\ttarget: '.http_timeout'\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstates: {\n\t\t\t\t\t\trasa_query: {\n\t\t\t\t\t\t\t...nluRequest()\n\t\t\t\t\t\t},\n\t\t\t\t\t\tinvalid_query: {\n\t\t\t\t\t\t\t...promptAndAsk(\"Sorry, I don't understand, please say that again\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\thttp_timeout: {\n\t\t\t\t\t\t\t...promptAndAsk(\"Sorry, the rasa server isnt responding right now. Try again.\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tselect_task: {\n\t\t\t\t\tinitial: \"select\",\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\talways: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcond: (context) => context.snippet ===  \"Appointment\",\n\t\t\t\t\t\t\t\t\ttarget: \"#who\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcond: (context) => context.snippet  ===  \"TODO\",\n\t\t\t\t\t\t\t\t\ttarget: \"#todo\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcond: (context) => context.snippet  ===  \"Timer\",\n\t\t\t\t\t\t\t\t\ttarget: \"#timer\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult),\n\t\t\t\t\t\t\t\t\ttarget: \"prompt\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprompt: { \n\t\t\t\t\t\t\tentry: say(\"Sorry, that isn't a valid answer\"),\n\t\t\t\t\t\t\ton: { ENDSPEECH: \"#welcome\"} \n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttodo: {\n\t\t            id: \"todo\",\n\t\t\t\t\tinitial: \"prompt\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tENDSPEECH: \"#init\"\n\t\t\t\t\t},\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tprompt: {\n\t\t\t\t\t\t\tentry: say(\"You are in the to do thing.\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttimer: {\n\t\t            id: \"timer\",\n\t\t\t\t\tinitial: \"prompt\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tENDSPEECH: \"#init\"\n\t\t\t\t\t},\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tprompt: {\n\t\t\t\t\t\t\tentry: say(\"You are in the timer thing.\")\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t        who: {\n\t\t            id: \"who\",\n\t\t            initial: \"prompt\",\n\t\t            on: {\n\t\t                RECOGNISED: [{\n\t\t                    cond: (context) => \"person\" in (grammar[context.recResult] || {}),\n\t\t                    actions: assign((context) => { return { person: grammar[context.recResult].person }}),\n\t\t                    target: \"day\"\n\t\t                },\n\t\t                { \n\t\t\t\t\t\t\ttarget: \".nomatch\" ,\n\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t}]\n\t\t            },\n\t\t            states: {\n\t\t                prompt: {\n\t\t                    ...promptAndAsk(\"Who are you meeting with?\")\n\t\t                },\n\t\t                nomatch: {\n\t\t                    entry: say(\"Sorry I don't know them\"),\n\t\t                    on: { ENDSPEECH: \"prompt\" }\n\t\t                }\n\t\t            }\n\t\t        },\n\t\t        day: {\n\t\t            initial: \"prompt\",\n\t\t            on: {\n\t\t                RECOGNISED: [{\n\t\t                    cond: (context) => \"day\" in (grammar[context.recResult] || {}),\n\t\t                    actions: assign((context) => { return { day: grammar[context.recResult].day } }),\n\t\t                    target: \"whole_day_query\"\n\t\t\n\t\t                },\n\t\t                { \n\t\t\t\t\t\t\ttarget: \".nomatch\",\n\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t}]\n\t\t            },\n\t\t            states: {\n\t\t                prompt: {\n\t\t                    entry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `OK. ${context.person}. On which day is your meeting?`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t                ask: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: 5000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t]\n\t\t\t            },\n\t\t                nomatch: {\n\t\t                    entry: say(\"Can you please repeat that\"),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                }\n\t\t            }\n\t\t        },\n\t\t        whole_day_query: {\n\t\t            initial: \"prompt\",\n\t\t            on: {\n\t\t                RECOGNISED: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: (context) => \"bool_val\" in (grammar[context.recResult] || {}) && (grammar[context.recResult].bool_val == false),\n\t\t                    actions: assign((context) => { return { bool_val: grammar[context.recResult].bool_val } }),\n\t\t                    target: \"meeting_time_query\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: (context) => \"bool_val\" in (grammar[context.recResult] || {}) && (grammar[context.recResult].bool_val == true),\n\t\t                    actions: assign((context) => { return { bool_val: grammar[context.recResult].bool_val } }),\n\t\t                    target: \"confirm_full_day\"\n\t\t\t\t\t\t},\n\t\t                { \n\t\t\t\t\t\t\ttarget: \".nomatch\" ,\n\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}]\n\t\t            },\n\t\t            states: {\n\t\t                prompt: {\n\t\t                    entry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `Will the meeting take the whole day?`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t                ask: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: 5000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t]\n\t\t\t            },\n\t\t                nomatch: {\n\t\t                    entry: say(\"Can you please repeat that\"),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t            }\n\t\t        },\n\t\t        meeting_time_query: {\n\t\t            initial: \"prompt\",\n\t\t            on: {\n\t\t                RECOGNISED: [{\n\t\t                    cond: (context) => \"time\" in (grammar[context.recResult] || {}),\n\t\t                    actions: assign((context) => { return { time: grammar[context.recResult].time } }),\n\t\t                    target: \"confirm_day_and_time\"\n\t\t\n\t\t                },\n\t\t                { \n\t\t\t\t\t\t\ttarget: \".nomatch\" ,\n\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t}]\n\t\t            },\n\t\t            states: {\n\t\t                prompt: {\n\t\t                    entry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `What time is the meeting?`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t                ask: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: 5000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t]\n\t\t\t            },\n\t\t                nomatch: {\n\t\t                    entry: say(\"Can you please repeat that\"),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t            }\n\t\t        },\n\t\t\t\tconfirm_day_and_time: {\n\t\t            initial: \"prompt\",\n\t\t            on: {\n\t\t                RECOGNISED: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: (context) => \"bool_val\" in (grammar[context.recResult] || {}) && (grammar[context.recResult].bool_val == false),\n\t\t                    actions: assign((context) => { return { bool_val: grammar[context.recResult].bool_val } }),\n\t\t                    target: \"#init\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: (context) => \"bool_val\" in (grammar[context.recResult] || {}) && (grammar[context.recResult].bool_val == true),\n\t\t                    actions: assign((context) => { return { bool_val: grammar[context.recResult].bool_val } }),\n\t\t                    target: \"finalise\"\n\t\t\t\t\t\t},\n\t\t                { \n\t\t\t\t\t\t\ttarget: \".nomatch\" ,\n\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t}]\n\t\t            },\n\t\t            states: {\n\t\t                prompt: {\n\t\t                    entry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `Do you want to create an appointment with ${context.person} on ${context.day} at ${context.time}?`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t                ask: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: 5000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t]\n\t\t\t            },\n\t\t                nomatch: {\n\t\t                    entry: say(\"Can you please repeat that\"),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t            }\n\t\t        },\n\t\t\t\tconfirm_full_day: {\n\t\t            initial: \"prompt\",\n\t\t            on: {\n\t\t                RECOGNISED: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: (context) => \"bool_val\" in (grammar[context.recResult] || {}) && (grammar[context.recResult].bool_val == false),\n\t\t                    actions: assign((context) => { return { bool_val: grammar[context.recResult].bool_val } }),\n\t\t                    target: \"#init\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: (context) => \"bool_val\" in (grammar[context.recResult] || {}) && (grammar[context.recResult].bool_val == true),\n\t\t                    actions: assign((context) => { return { bool_val: grammar[context.recResult].bool_val } }),\n\t\t                    target: \"finalise\"\n\t\t\t\t\t\t},\n\t\t                { \n\t\t\t\t\t\t\ttarget: \".nomatch\" ,\n\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t}]\n\t\t            },\n\t\t            states: {\n\t\t                prompt: {\n\t\t                    entry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `Do you want to create an appointment with ${context.person} on ${context.day} for the whole day?`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t                ask: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: 5000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t]\n\t\t\t            },\n\t\t                nomatch: {\n\t\t                    entry: say(\"Can you please repeat that\"),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t                },\n\t\t            }\n\t\t        },\n\t\t\t\tfinalise: {\n\t\t\t\t\tentry: say(\"Your appointment has been created.\"),\n\t\t\t\t\ton: { ENDSPEECH: \"#init.main\" }\n\t\t\t\t},\n\t\t\t\tsay_error: {\n\t\t\t\t\ttarget: 'main',\n\t\t\t\t\tactions: say(\"Sorry, there was an error. \")\n\t\t\t\t},\n\t\t    },\n\t\t},\n\t\tmaxspeech: {\n\t\t\tentry: say(\"Sorry,\"),\n\t\t\ton: {\n\t\t\t\tENDSPEECH: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcond: (context)=> context.maxspeech_count < 3,\n\t\t\t\t\t\ttarget: 'main.hist'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tactions: assign((context) => { return { maxspeech_count: 0 } }),\n\t\t\t\t\t\ttarget: '#init'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t},\n\t\tstop: {\n\t\t\tentry: say(\"Ok, program stopped\"),\n\t\t\ttarget: 'main'\n\t\t},\n\t\thelp: {\n\t\t\tentry: say(\"I'm supposed to help you but I won't\"),\n\t\t\ttarget: 'main'\n\t\t},\n\t},\n\t\t\n})\n\n\n\n\n\n\n\n\n\n","import \"./styles.scss\";\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { Machine, assign, actions, State } from \"xstate\";\nconst { send, cancel } = actions;\nimport { useMachine, asEffect } from \"@xstate/react\";\nimport { inspect } from \"@xstate/inspect\";\nimport { dmMachine } from \"./dmAppointmentUpdated\";\n\n\ninspect({\n    url: \"https://statecharts.io/inspect\",\n    iframe: false\n});\n\nimport { useSpeechSynthesis, useSpeechRecognition } from 'react-speech-kit';\n\n\nconst machine = Machine<SDSContext, any, SDSEvent>({\n    id: 'root',\n    type: 'parallel',\n    states: {\n        dm: {\n            ...dmMachine\n        },\n        asrtts: {\n            initial: 'idle',\n            states: {\n                idle: {\n                    on: {\n                        LISTEN: 'recognising',\n                        SPEAK: {\n                            target: 'speaking',\n                            actions: assign((_context, event) => { return { ttsAgenda: event.value } })\n                        }\n                    }\n                },\n                recognising: {\n                    initial: 'progress',\n                    entry: 'recStart',\n                    exit: 'recStop',\n                    on: {\n                        ASRRESULT: {\n                            actions: ['recLogResult',\n                                assign((_context, event) => { return { recResult: event.value.toLowerCase() } })],\n                            target: '.match'\n                        },\n                        RECOGNISED: {\n\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\tcancel('maxspeech_cancel'),\n\t\t\t\t\t\t\t\tassign((_context, event) => { return { maxspeech_count: 0 } })\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ttarget: 'idle'\n\t\t\t\t\t\t},\n                        MAXSPEECH: [\n\t                        {\n\t\t\t\t\t\t\t\tcond: context=> context.maxspeech_count < 3,\n\t\t\t\t\t\t\t\ttarget:'idle',\n\t\t\t\t\t\t\t\tactions: assign((_context, event) => { return { maxspeech_count: _context.maxspeech_count +1 } }),\n\t                        },\n\t                        {\n\t\t\t\t\t\t\t\ttarget:'idle'\n\t                        },\n\t                    ]\n                    },\n                    states: {\n                        progress: {\n                        },\n                        match: {\n                            entry: send('RECOGNISED'),\n                        },\n                    }\n                },\n                speaking: {\n                    entry: 'ttsStart',\n                    on: {\n                        ENDSPEECH: 'idle',\n                    }\n                }\n            }\n        }\n    },\n},\n    {\n        actions: {\n            recLogResult: (context: SDSContext) => {\n                /* context.recResult = event.recResult; */\n                console.log('<< ASR: ' + context.recResult);\n            },\n            test: () => {\n                console.log('test')\n            },\n            logIntent: (context: SDSContext) => {\n                /* context.nluData = event.data */\n                console.log('<< NLU intent: ' + context.nluData.intent.name)\n            }\n        },\n    });\n\n\n\ninterface Props extends React.HTMLAttributes<HTMLElement> {\n    state: State<SDSContext, any, any, any>;\n}\nconst ReactiveButton = (props: Props): JSX.Element => {\n    switch (true) {\n        case props.state.matches({ asrtts: 'recognising' }):\n            return (\n                <button type=\"button\" className=\"glow-on-hover\"\n                    style={{ animation: \"glowing 20s linear\" }} {...props}>\n                    Listening...\n                </button>\n            );\n        case props.state.matches({ asrtts: 'speaking' }):\n            return (\n                <button type=\"button\" className=\"glow-on-hover\"\n                    style={{ animation: \"bordering 1s infinite\" }} {...props}>\n                    Speaking...\n                </button>\n            );\n        default:\n            return (\n                <button type=\"button\" className=\"glow-on-hover\" {...props}>\n                    Click to start\n                </button >\n            );\n    }\n}\n\nfunction App() {\n    const { speak, cancel, speaking } = useSpeechSynthesis({\n        onEnd: () => {\n            send('ENDSPEECH');\n        },\n    });\n    const { listen, listening, stop } = useSpeechRecognition({\n        onResult: (result: any) => {\n            send({ type: \"ASRRESULT\", value: result });\n        },\n    });\n    const [current, send, service] = useMachine(machine, {\n        devTools: true,\n        actions: {\n            recStart: asEffect(() => {\n                console.log('LETS GOOOOOO');\n                listen({\n                    interimResults: false,\n                    continuous: true\n                });\n            }),\n            recStop: asEffect(() => {\n                console.log('Recognition stopped.');\n                stop()\n            }),\n            changeColour: asEffect((context) => {\n                console.log('Repainting...');\n                document.body.style.background = context.recResult;\n            }),\n            ttsStart: asEffect((context, effect) => {\n                console.log('Speaking...');\n                speak({ text: context.ttsAgenda })\n            }),\n            ttsCancel: asEffect((context, effect) => {\n                console.log('TTS STOP...');\n                cancel()\n            })\n            /* speak: asEffect((context) => {\n\t     * console.log('Speaking...');\n             *     speak({text: context.ttsAgenda })\n             * } */\n        }\n    });\n\n\n    return (\n        <div className=\"App\">\n            <ReactiveButton state={current} onClick={() => send('CLICK')} />\n        </div>\n    )\n};\n\n\n\n//RASA\n\nconst proxyurl = \"https://cors-anywhere.herokuapp.com/\";\nconst rasaurl = 'https://rasajacobcoles.herokuapp.com/model/parse'\nconst nluRequest = (text: string) =>\n    fetch(new Request(proxyurl + rasaurl, {\n        method: 'POST',\n        headers: { 'Origin': 'http://maraev.me' }, // only required with proxy\n        body: `{\"text\": \"${text}\"}`\n    }))\n        .then(data => data.json());\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n    <App />,\n    rootElement);\n"]}}