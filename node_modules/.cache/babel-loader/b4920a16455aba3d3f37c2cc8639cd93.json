{"ast":null,"code":"import _objectSpread from \"/Users/jacobcoles/Desktop/LT2216/final_project/final_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { actions, assign } from \"xstate\";\nconst send = actions.send,\n      cancel = actions.cancel;\n\nfunction say(text) {\n  return send(_context => ({\n    type: \"SPEAK\",\n    value: text\n  }));\n}\n\nfunction listen() {\n  return send('LISTEN');\n}\n\nconst grammar = {\n  \"quick math\": {\n    quick_math: null\n  },\n  \"quick maths\": {\n    quick_math: null\n  },\n  \"play quick math\": {\n    quick_math: null\n  },\n  \"play quick maths\": {\n    quick_math: null\n  },\n  \"riddles\": {\n    riddles: null\n  },\n  \"riddle\": {\n    riddles: null\n  },\n  \"tell me a riddle\": {\n    riddles: null\n  },\n  \"play riddles\": {\n    riddles: null\n  },\n  \"memory game\": {\n    chimp_test: null\n  },\n  \"memory test\": {\n    chimp_test: null\n  },\n  \"number test\": {\n    chimp_test: null\n  },\n  \"number memory test\": {\n    chimp_test: null\n  },\n  \"the memory game\": {\n    chimp_test: null\n  },\n  \"the memory test\": {\n    chimp_test: null\n  },\n  \"the number test\": {\n    chimp_test: null\n  },\n  \"the number memory test\": {\n    chimp_test: null\n  },\n  \"number sequence game\": {\n    chimp_test: null\n  },\n  \"the number sequence game\": {\n    chimp_test: null\n  }\n};\nconst math_operator_store = {\n  operate: function operate(a, b, operator) {\n    switch (operator) {\n      case 'plus':\n        return a + b;\n\n      case 'subtract':\n        return a - b;\n\n      case 'times':\n        return a * b;\n      //~ case 'divide':\n      //~ return a/b\n    }\n  },\n  generate_number: function generate_number(operator) {\n    switch (operator) {\n      case 'plus':\n        return Math.floor(Math.random() * 100);\n\n      case 'subtract':\n        return Math.floor(Math.random() * 100);\n\n      case 'times':\n        return Math.floor(Math.random() * 12);\n      //~ case 'divide': //division can be a bit hard on the spot for a user\n      //~ return a/b\n    }\n  },\n  parse_asr_numbers: function parse_asr_numbers(input) {\n    const numbers = {\n      0: 'zero',\n      1: 'one',\n      2: 'two',\n      3: 'three',\n      4: 'four',\n      5: 'five',\n      6: 'six',\n      7: 'seven',\n      8: 'eight',\n      9: 'nine'\n    };\n\n    for (var i = 0; i < numbers.length; i++) {\n      input = input.replace(numbers[i], i);\n    }\n\n    input = input.replace('for', 4);\n    input = input.replace('to', 2);\n    input = input.replace('too', 2);\n    return input.split(/[\\s--,.+]/).join('');\n  },\n  0: {\n    operator: \"plus\"\n  },\n  1: {\n    operator: \"subtract\"\n  },\n  2: {\n    operator: \"times\"\n  },\n  3: {\n    operator: \"divide\"\n  }\n};\nconst riddles_store = {\n  0: {\n    riddle: \"What has to be broken before you can use it?\",\n    answers: [\"egg\", \"an egg\"],\n    hint: \"I like them scrambled. \"\n  },\n  1: {\n    riddle: \"What gets wet while drying?\",\n    answers: [\"towel\", \"a towel\", \"towels\"],\n    hint: \"You'll have to take one to the beach if you want to take a swim. \"\n  },\n  2: {\n    riddle: \"What can you give and still hold on to?\",\n    answers: [\"promise\", \"a promise\", \"promises\", \"your word\"],\n    hint: \"Relationships are more secure with these. \"\n  },\n  3: {\n    riddle: \"The more of this there is, the less you see. What is it?\",\n    answers: [\"darkness\", \"the dark\"],\n    hint: \"This descibes the absence rather than the presence of something. \"\n  },\n  4: {\n    riddle: \"This is as light as a feather, but you can't hold it too long. \",\n    answers: [\"your breath\", \"breath\", \"the breath\", \"a breath\"],\n    hint: \"Don't forget to do this or you'll die.\"\n  },\n  5: {\n    riddle: \"Before Mount Everest was discovered, what was the highest mountain on Earth?\",\n    answers: [\"everest\", \"mount everest\"],\n    hint: \"If nobody is there to observe it does that mean it is not true?\"\n  },\n  6: {\n    riddle: \"What runs around the whole yard without moving?\",\n    answers: [\"a fence\", \"fence\", \"fences\"],\n    hint: \"Some things described as running may be static. \"\n  },\n  7: {\n    riddle: \"What can you catch, but never throw?\",\n    answers: [\"a cold\", \"a virus\", \"a sickness\", \"a disease\", \"cold\", \"virus\", \"sickness\", \"disease\", \"colds\", \"viruses\", \"sicknesses\", \"diseases\"],\n    hint: \"Covid 19 has not been a great thing for the world. \"\n  }\n};\n\nfunction promptAndAsk(prompt) {\n  return {\n    initial: 'prompt',\n    states: {\n      prompt: {\n        entry: say(prompt),\n        on: {\n          ENDSPEECH: 'ask'\n        }\n      },\n      ask: {\n        entry: [send('LISTEN'), send('MAXSPEECH', {\n          delay: 6000,\n          id: 'maxspeech_cancel'\n        })]\n      }\n    }\n  };\n}\n\nconst proxyurl = \"https://cors-anywhere.herokuapp.com/\"; //\"https://boiling-depths-26621.herokuapp.com/\" alternate url\n\nconst rasaurl = 'https://herokufinalproj.herokuapp.com/model/parse';\nconst commands = ['stop', 'help'];\nvar maxspeech_count_local = 0;\nexport const dmMachine = {\n  initial: 'main',\n  id: 'init',\n  context: {\n    maxspeech_count: 0\n  },\n  on: {\n    MAXSPEECH: '.maxspeech',\n    RECOGNISED: [{\n      target: \".stop\",\n      cond: context => context.recResult === 'stop'\n    }, {\n      target: \".help\",\n      cond: context => context.recResult === 'help'\n    }]\n  },\n  states: {\n    main: {\n      initial: 'clicky',\n      states: {\n        hist: {\n          type: 'history',\n          history: 'shallow'\n        },\n        clicky: {\n          on: {\n            CLICK: {\n              target: 'begin',\n              actions: assign(context => {\n                maxspeech_count_local = 0;\n                return {\n                  maxspeech_count: 0\n                };\n              })\n            }\n          }\n        },\n        begin: {\n          initial: \"prompt\",\n          id: \"welcome\",\n          on: {\n            MAX_HTTP: {\n              target: '#init',\n              actions: say('The RASA server is taking too long to respond. Please wait and try again. ')\n            },\n            NLU_REQ_DONE: [{\n              cond: context => context.snippet === \"chimp_test\",\n              target: \"chimp_test\"\n            }, {\n              target: \"quick_math\",\n              cond: (context, event) => context.snippet === \"quick_math\"\n            }, {\n              target: \"riddles\",\n              cond: context => context.snippet === \"riddles\"\n            }, {\n              target: \".re_prompt\"\n            }],\n            RECOGNISED: '.nlu_process',\n            MAXSPEECH: '.too_long'\n          },\n          states: {\n            prompt: _objectSpread({}, promptAndAsk(\"Hello! You have a selection of one of the following mini games. You can choose between quick maths, riddles or the number memory test. You can also tell me to stop or ask for help at any time. \")),\n            nlu_process: {\n              initial: 'http_timer',\n              invoke: {\n                id: \"rasaquery\",\n                src: (context, event) => {\n                  return fetch(new Request(proxyurl + rasaurl, {\n                    method: 'POST',\n                    headers: {\n                      'Origin': 'http://localhost:3000/'\n                    },\n                    // only required with proxy\n                    body: \"{\\\"text\\\": \\\"\".concat(context.recResult, \"\\\"}\")\n                  })).then(data => data.json());\n                },\n                onDone: 'completed_query',\n                onError: {\n                  target: '#init',\n                  actions: say(\"Sorry, there was an error. \")\n                }\n              },\n              states: {\n                http_timer: {\n                  entry: send('MAX_HTTP', {\n                    delay: 12000,\n                    id: 'maxspeech_cancel'\n                  })\n                }\n              }\n            },\n            re_prompt: {\n              entry: say(\"Sorry, I didn't quite get that. Repeat yoself!\"),\n              on: {\n                ENDSPEECH: 'ask'\n              }\n            },\n            ask: {\n              entry: [send('LISTEN'), send('MAXSPEECH', {\n                delay: 7000,\n                id: 'maxspeech_cancel'\n              })]\n            },\n            completed_query: {\n              entry: [assign((context, event) => {\n                console.log(event.data.intent.name);\n                return {\n                  snippet: event.data.intent.name || 'unconfident_resp'\n                };\n              }), send(\"NLU_REQ_DONE\")]\n            },\n            too_long: {\n              entry: say('Still there?'),\n              on: {\n                ENDSPEECH: [{\n                  target: '#init',\n                  cond: context => context.maxspeech_counter > 2,\n                  actions: say(\"As you haven't responded; resetting...\")\n                }, {\n                  target: 'ask',\n                  actions: assign(context => {\n                    return {\n                      maxspeech_counter: (context.maxspeech_counter || 0) + 1\n                    };\n                  })\n                }]\n              }\n            }\n          }\n        },\n        quick_math: {\n          id: \"quick_math\",\n          initial: \"generate_math_question\",\n          on: {\n            MAXSPEECH: '.too_long',\n            RECOGNISED: [{\n              target: '.right_answer',\n              cond: context => context.recResult === context.solution.toString(),\n              actions: assign(context => {\n                return {\n                  points: (context.points || 0) + 1,\n                  wrong_math: 0\n                };\n              })\n            }, {\n              target: \".wrong_answer\",\n              cond: context => !commands.includes(context.recResult)\n            }]\n          },\n          states: {\n            generate_math_question: {\n              entry: say(\"Here is your maths question\"),\n              on: {\n                ENDSPEECH: {\n                  target: \"ask_math_question\",\n                  actions: assign(context => {\n                    var operator_id = Math.floor(Math.random() * 3);\n                    var operator = math_operator_store[operator_id].operator;\n                    return {\n                      number_one: math_operator_store.generate_number(operator),\n                      number_two: math_operator_store.generate_number(operator),\n                      operator_id: operator_id\n                    };\n                  })\n                }\n              }\n            },\n            ask_math_question: {\n              entry: send(context => ({\n                type: \"SPEAK\",\n                value: \"What is \".concat(context.number_one, \" \").concat(math_operator_store[context.operator_id].operator, \" \").concat(context.number_two, \".\")\n              })),\n              on: {\n                ENDSPEECH: {\n                  target: \"ask\",\n                  actions: assign(context => {\n                    return {\n                      solution: math_operator_store.operate(context.number_one, context.number_two, math_operator_store[context.operator_id].operator)\n                    };\n                  })\n                }\n              }\n            },\n            wrong_answer: {\n              entry: say(\"Sorry, that's wrong!\"),\n              on: {\n                ENDSPEECH: [{\n                  target: 'try_again',\n                  actions: assign(context => {\n                    return {\n                      wrong_math: (context.wrong_math || 0) + 1\n                    };\n                  }),\n                  cond: context => (context.wrong_math || 0) < 2\n                }, {\n                  target: '#init',\n                  actions: say(\"... and you've gotten it wrong a couple of times now! Resetting...\")\n                }]\n              }\n            },\n            right_answer: {\n              entry: send(context => ({\n                type: \"SPEAK\",\n                value: \"Nice, that's right. You have \".concat(context.points, \" \").concat(context.points === 1 ? 'point' : 'points', \".\")\n              })),\n              on: {\n                ENDSPEECH: {\n                  target: \"generate_math_question\"\n                }\n              }\n            },\n            too_long: {\n              entry: say('Still there?'),\n              on: {\n                ENDSPEECH: [{\n                  target: '#init',\n                  cond: context => context.maxspeech_counter > 2,\n                  actions: [assign(context => {\n                    return {\n                      maxspeech_counter: 0\n                    };\n                  }), say(\"As you haven't responded; resetting...\")]\n                }, {\n                  target: 'ask',\n                  actions: assign(context => {\n                    return {\n                      maxspeech_counter: (context.maxspeech_counter || 0) + 1\n                    };\n                  })\n                }]\n              }\n            },\n            try_again: {\n              entry: say(\"Try again.\"),\n              on: {\n                ENDSPEECH: 'ask'\n              }\n            },\n            ask: {\n              entry: [send('LISTEN'), send('MAXSPEECH', {\n                delay: 7000,\n                id: 'maxspeech_cancel'\n              })]\n            }\n          }\n        },\n        riddles: {\n          id: \"riddles\",\n          initial: \"prompt\",\n          on: {\n            MAXSPEECH: '.too_long',\n            RECOGNISED: [{\n              cond: context => riddles_store[context.riddle_id].answers.includes(context.recResult),\n              actions: [assign(context => {\n                return {\n                  wrong_riddle: 0\n                };\n              })],\n              target: '.another_riddle'\n            }, {\n              cond: context => context.recResult == ('hint' || 'hint please'),\n              target: '.hint'\n            }, {\n              target: \".wrong_answer\",\n              cond: context => !commands.includes(context.recResult)\n            }]\n          },\n          states: {\n            prompt: {\n              entry: say(\"Guess the answer to the riddle. Don't be afraid to ask for a hint. Here is your riddle: \"),\n              on: {\n                ENDSPEECH: {\n                  target: \"ask_riddle\",\n                  actions: assign(context => {\n                    return {\n                      riddle_id: Math.floor(Math.random() * 7)\n                    };\n                  })\n                }\n              }\n            },\n            hint: {\n              entry: send(context => ({\n                type: \"SPEAK\",\n                value: \"The hint is:\\n \".concat(riddles_store[context.riddle_id].hint, \" Now tell me...\")\n              })),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask_riddle: {\n              entry: send(context => ({\n                type: \"SPEAK\",\n                value: \"\".concat(riddles_store[context.riddle_id].riddle)\n              })),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            too_long: {\n              entry: say('Hello?'),\n              on: {\n                ENDSPEECH: [{\n                  target: '#init',\n                  actions: say(\"As you haven't responded, resetting...\"),\n                  cond: context => context.maxspeech_counter > 1\n                }, {\n                  target: 'ask',\n                  actions: [assign(context => {\n                    return {\n                      maxspeech_counter: (context.maxspeech_counter || 0) + 1\n                    };\n                  })]\n                }]\n              }\n            },\n            wrong_answer: {\n              entry: say(\"Sorry, that's wrong!\"),\n              on: {\n                ENDSPEECH: [{\n                  target: 'try_again',\n                  actions: assign(context => {\n                    return {\n                      wrong_riddle: (context.wrong_riddle || 0) + 1\n                    };\n                  }),\n                  cond: context => (context.wrong_riddle || 0) < 2\n                }, {\n                  target: '#init',\n                  actions: say(\"You've gotten it wrong a couple of times now! Resetting...\")\n                }]\n              }\n            },\n            try_again: {\n              entry: say(\"Try again.\"),\n              on: {\n                ENDSPEECH: 'ask'\n              }\n            },\n            another_riddle: {\n              entry: say(\"Well done, that is correct! Would you like another riddle?\"),\n              on: {\n                RECOGNISED: [{\n                  target: 'prompt',\n                  //actions: assign(context=>{ return { wrong_riddle: (context.wrong_riddle || 0) +1 } }),\n                  cond: context => (context.recResult || \"invalid\") == \"yes\"\n                }, {\n                  target: '#init',\n                  actions: say(\"Ok, resetting.\")\n                }]\n              }\n            },\n            ask: {\n              entry: [send('LISTEN'), send('MAXSPEECH', {\n                delay: 15000,\n                id: 'maxspeech_cancel'\n              })]\n            }\n          }\n        },\n        chimp_test: {\n          id: \"chimp_test\",\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: [{\n              target: '.correct_sequence',\n              actions: assign(context => {\n                context.sequence.push(Math.floor(Math.random() * 9));\n                return {\n                  one_try_given: false\n                };\n              }),\n              cond: context => math_operator_store.parse_asr_numbers(context.recResult) === context.sequence.join('')\n            }, {\n              target: \".wrong_sequence\",\n              cond: context => !commands.includes(context.recResult)\n            }],\n            MAXSPEECH: '.too_long'\n          },\n          states: {\n            prompt: {\n              entry: say(\"This is the number memory test. I will say an ever increasing sequence of numbers which you need to repeat back to me. If you can't recall a sequence you lose. Try to get the highest score!\"),\n              on: {\n                ENDSPEECH: {\n                  target: 'say_sequence',\n                  actions: assign(context => {\n                    return {\n                      sequence: [Math.floor(Math.random() * 9)]\n                    };\n                  })\n                }\n              }\n            },\n            say_sequence: {\n              entry: send(context => ({\n                type: \"SPEAK\",\n                value: \"The \".concat(context.sequence.length === 1 ? 'first' : 'next', \" number is \").concat(context.sequence[context.sequence.length - 1], \". Repeat back the sequence\")\n              })),\n              on: {\n                ENDSPEECH: 'ask'\n              }\n            },\n            correct_sequence: {\n              entry: send(context => ({\n                type: \"SPEAK\",\n                value: \"Good job! You have \".concat(context.sequence.length - 1, \" \").concat(context.sequence.length - 1 === 1 ? 'point' : 'points', \".\")\n              })),\n              on: {\n                ENDSPEECH: \"say_sequence\"\n              }\n            },\n            wrong_sequence: {\n              entry: say('That is incorrect. '),\n              on: {\n                ENDSPEECH: [{\n                  target: 'say_sequence',\n                  cond: context => {\n                    return !(context.one_try_given || false);\n                  },\n                  actions: [assign(context => {\n                    return {\n                      one_try_given: true\n                    };\n                  }), say(\"I will give you one more chance to get that right or you lose.\")]\n                }, {\n                  actions: send(context => ({\n                    type: \"SPEAK\",\n                    value: \"You ended with \".concat(context.sequence.length - 1, \" points\")\n                  })),\n                  target: '#init'\n                }]\n              }\n            },\n            ask: {\n              entry: [send('LISTEN'), send('MAXSPEECH', {\n                delay: context => 4000 + 1000 * context.sequence.length,\n                id: 'maxspeech_cancel'\n              })]\n            },\n            too_long: {\n              entry: say('Hello?'),\n              on: {\n                ENDSPEECH: [{\n                  target: '#init',\n                  actions: say(\"As you haven't responded, resetting...\"),\n                  cond: context => context.maxspeech_counter > 1\n                }, {\n                  target: 'ask',\n                  actions: [assign(context => {\n                    return {\n                      maxspeech_counter: (context.maxspeech_counter || 0) + 1\n                    };\n                  })]\n                }]\n              }\n            }\n          }\n        },\n        please_repeat: {\n          id: \"please_repeat\",\n          initial: \"prompt\",\n          states: {\n            prompt: {\n              entry: say(\"Sorry, I didn't get that. \")\n            }\n          },\n          on: {\n            ENDSPEECH: \"#init\"\n          }\n        }\n      }\n    },\n    maxspeech: {\n      initial: 'apologies',\n      on: {\n        ENDSPEECH: [{\n          target: '#init.main.hist',\n          cond: function cond() {\n            return maxspeech_count_local < 2;\n          },\n          actions: [function () {\n            maxspeech_count_local++;\n          }, assign(context => {\n            context;\n          })]\n        }, {\n          target: '#init',\n          actions: [function () {\n            maxspeech_count_local = 0;\n          }, say(\"and you haven't responded in a while. Resetting.\"), assign(context => {\n            context;\n          })]\n        }]\n      },\n      states: {\n        apologies: {\n          entry: say(\"Sorry, I couldn't hear you. \")\n        }\n      }\n    },\n    stop: {\n      entry: say(\"Ok, program stopped\"),\n      on: {\n        ENDSPEECH: {\n          target: '#init'\n        }\n      }\n    },\n    help: {\n      entry: say(\"Here is a help message, but you made the game, so you shouldn't need one. Going back to the game...\"),\n      on: {\n        ENDSPEECH: {\n          target: 'main.hist'\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/Users/jacobcoles/Desktop/LT2216/final_project/final_project/src/final_project.ts"],"names":["actions","assign","send","cancel","say","text","_context","type","value","listen","grammar","quick_math","riddles","chimp_test","math_operator_store","operate","a","b","operator","generate_number","Math","floor","random","parse_asr_numbers","input","numbers","i","length","replace","split","join","riddles_store","riddle","answers","hint","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","delay","id","proxyurl","rasaurl","commands","maxspeech_count_local","dmMachine","context","maxspeech_count","MAXSPEECH","RECOGNISED","target","cond","recResult","main","hist","history","clicky","CLICK","begin","MAX_HTTP","NLU_REQ_DONE","snippet","event","nlu_process","invoke","src","fetch","Request","method","headers","body","then","data","json","onDone","onError","http_timer","re_prompt","completed_query","console","log","intent","name","too_long","maxspeech_counter","solution","toString","points","wrong_math","includes","generate_math_question","operator_id","number_one","number_two","ask_math_question","wrong_answer","right_answer","try_again","riddle_id","wrong_riddle","ask_riddle","another_riddle","sequence","push","one_try_given","say_sequence","correct_sequence","wrong_sequence","please_repeat","maxspeech","apologies","stop","help"],"mappings":"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","sourcesContent":["import { MachineConfig, actions, Action, assign } from \"xstate\";\nconst { send, cancel } = actions;\n\n\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction listen(): Action<SDSContext, SDSEvent> {\n    return send('LISTEN')\n}\n\nconst grammar: { [index: string]: { person?: string, day?: string, time?: string, bool_val?: boolean, initial_function: string } } = {\n\n\t\"quick math\": { quick_math: null },\n\t\"quick maths\": { quick_math: null },\n\t\"play quick math\": { quick_math: null },\n\t\"play quick maths\": { quick_math: null },\n\t\n\t\"riddles\": { riddles: null },\n\t\"riddle\": { riddles: null },\n\t\"tell me a riddle\": { riddles: null },\n\t\"play riddles\": { riddles: null },\n\t\n\t\"memory game\": { chimp_test: null },\n\t\"memory test\": { chimp_test: null },\n\t\"number test\": { chimp_test: null },\n\t\"number memory test\": { chimp_test: null },\n\t\"the memory game\": { chimp_test: null },\n\t\"the memory test\": { chimp_test: null },\n\t\"the number test\": { chimp_test: null },\n\t\"the number memory test\": { chimp_test: null },\n\t\"number sequence game\": { chimp_test: null },\n\t\"the number sequence game\": { chimp_test: null },\n\t\n\t\n}\n\n\nconst math_operator_store = {\n\toperate: function(a,b,operator){\n\t\tswitch(operator){\n\t\t\tcase 'plus': \n\t\t\t\treturn a+b\n\t\t\tcase 'subtract': \n\t\t\t\treturn a-b\n\t\t\tcase 'times': \n\t\t\t\treturn a*b\n\t\t\t//~ case 'divide':\n\t\t\t\t//~ return a/b\n\t\t\t}\n\t\t},\n\tgenerate_number: function(operator){\n\t\tswitch(operator){\n\t\t\tcase 'plus': \n\t\t\t\treturn Math.floor(Math.random() * 100)\n\t\t\tcase 'subtract': \n\t\t\t\treturn Math.floor(Math.random() * 100)\n\t\t\tcase 'times': \n\t\t\t\treturn Math.floor(Math.random() * 12)\n\t\t\t//~ case 'divide': //division can be a bit hard on the spot for a user\n\t\t\t\t//~ return a/b\n\t\t}\n\t},\n\tparse_asr_numbers: function(input){\n\t\tconst numbers = {\n\t\t\t0: 'zero',\n\t\t\t1: 'one',\n\t\t\t2: 'two',\n\t\t\t3: 'three',\n\t\t\t4: 'four',\n\t\t\t5: 'five',\n\t\t\t6: 'six',\n\t\t\t7: 'seven',\n\t\t\t8: 'eight',\n\t\t\t9: 'nine',\n\t\t}\n\t\tfor (var i = 0; i < numbers.length; i++) {\n\t\t\tinput = input.replace(numbers[i], i)\n\t\t}\n\t\tinput = input.replace('for', 4)\n\t\tinput = input.replace('to', 2)\n\t\tinput = input.replace('too', 2)\n\t\treturn input.split(/[\\s--,.+]/).join('') \n\t},\n\t0: {\n\t\toperator: \"plus\",\n\t},\n\t1: {\n\t\toperator: \"subtract\",\n\t},\n\t2: {\n\t\toperator: \"times\",\n\t},\n\t3: {\n\t\toperator: \"divide\",\n\t},\n}\n\nconst riddles_store = {\n\t0: {\n\t\triddle: \"What has to be broken before you can use it?\",\n\t\tanswers: [\n\t\t\t\"egg\",\n\t\t\t\"an egg\",\n\t\t],\n\t\thint: \"I like them scrambled. \"\n\t},\n\t1: {\n\t\triddle: \"What gets wet while drying?\",\n\t\tanswers: [\n\t\t\t\"towel\",\n\t\t\t\"a towel\",\n\t\t\t\"towels\",\n\t\t],\n\t\thint: \"You'll have to take one to the beach if you want to take a swim. \"\n\t},\n\t2: {\n\t\triddle: \"What can you give and still hold on to?\",\n\t\tanswers: [\n\t\t\t\"promise\",\n\t\t\t\"a promise\",\n\t\t\t\"promises\",\n\t\t\t\"your word\"\n\t\t],\n\t\thint: \"Relationships are more secure with these. \"\n\t},\n\t3: {\n\t\triddle: \"The more of this there is, the less you see. What is it?\",\n\t\tanswers: [\n\t\t\t\"darkness\",\n\t\t\t\"the dark\",\n\t\t],\n\t\thint: \"This descibes the absence rather than the presence of something. \"\n\t},\n\t4: {\n\t\triddle: \"This is as light as a feather, but you can't hold it too long. \",\n\t\tanswers: [\n\t\t\t\"your breath\",\n\t\t\t\"breath\",\n\t\t\t\"the breath\",\n\t\t\t\"a breath\"\n\t\t],\n\t\thint: \"Don't forget to do this or you'll die.\"\n\t},\n\t5: {\n\t\triddle: \"Before Mount Everest was discovered, what was the highest mountain on Earth?\",\n\t\tanswers: [\n\t\t\t\"everest\",\n\t\t\t\"mount everest\"\n\t\t],\n\t\thint: \"If nobody is there to observe it does that mean it is not true?\"\n\t},\n\t6: {\n\t\triddle: \"What runs around the whole yard without moving?\",\n\t\tanswers: [\n\t\t\t\"a fence\",\n\t\t\t\"fence\",\n\t\t\t\"fences\",\n\t\t],\n\t\thint: \"Some things described as running may be static. \"\n\t},\n\t7: {\n\t\triddle: \"What can you catch, but never throw?\",\n\t\tanswers: [\n\t\t\t\"a cold\",\n\t\t\t\"a virus\",\n\t\t\t\"a sickness\",\n\t\t\t\"a disease\",\n\t\t\t\"cold\",\n\t\t\t\"virus\",\n\t\t\t\"sickness\",\n\t\t\t\"disease\",\n\t\t\t\"colds\",\n\t\t\t\"viruses\",\n\t\t\t\"sicknesses\",\n\t\t\t\"diseases\",\n\t\t],\n\t\thint: \"Covid 19 has not been a great thing for the world. \"\n\t},\n\t\n}\n\nfunction promptAndAsk(prompt: string): MachineConfig<SDSContext, any, SDSEvent> {\n\t\n    return ({\n        initial: 'prompt',\n        states: {\n            prompt: {\n                entry: say(prompt),\n                on: { ENDSPEECH: 'ask' }\n            },\n            ask: {\n                entry: [\n\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\tsend( 'MAXSPEECH', { delay: 6000, id: 'maxspeech_cancel' } )\n\t\t\t\t]\n            },\n        }\n    })\n}\n\nconst proxyurl = \"https://cors-anywhere.herokuapp.com/\" //\"https://boiling-depths-26621.herokuapp.com/\" alternate url\nconst rasaurl = 'https://herokufinalproj.herokuapp.com/model/parse'\n\n\nconst commands = ['stop', 'help']\nvar maxspeech_count_local = 0\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'main',\n    id: 'init',\n    context: {\n\t\tmaxspeech_count: 0,\n\t},\n    on: {\n\t\tMAXSPEECH: '.maxspeech',\n\t\tRECOGNISED: \n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\ttarget: \".stop\",\n\t\t\t\t\tcond: (context) => context.recResult === 'stop' ,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttarget: \".help\",\n\t\t\t\t\tcond: (context) => context.recResult === 'help' ,\n\t\t\t\t}\n\t\t\t],\n\t},\n    states: {\n        main: {\n\t\t\tinitial: 'clicky',\n\t\t\tstates: {\n\t\t\t\thist: {\n\t\t\t\t\ttype: 'history',\n\t\t\t\t\thistory: 'shallow',\n\t\t\t\t },\n\t\t\t\tclicky: {\n\t\t\t\t\ton: {\n\t\t\t\t\t\tCLICK: {\n\t\t\t\t\t\t\ttarget: 'begin',\n\t\t\t\t\t\t\tactions: assign(context=>{maxspeech_count_local = 0; return { maxspeech_count: 0 } })\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbegin:{\n\t\t\t\t\tinitial: \"prompt\",\n\t\t\t\t\tid: \"welcome\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tMAX_HTTP: {\n\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\tactions: say('The RASA server is taking too long to respond. Please wait and try again. ')\n\t\t\t\t\t\t},\n\t\t\t\t\t\tNLU_REQ_DONE: [\n\t\t\t\t\t\t\t{\n\t\t\t                    cond: (context) => context.snippet === \"chimp_test\",\n\t\t\t                    target: \"chimp_test\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttarget: \"quick_math\",\n\t\t\t\t\t\t\t\tcond: (context, event) => context.snippet === \"quick_math\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttarget: \"riddles\",\n\t\t\t\t\t\t\t\tcond: (context) => context.snippet === \"riddles\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttarget: \".re_prompt\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t],\n\t\t\t\t\t\tRECOGNISED: '.nlu_process',\n\t\t\t\t\t\tMAXSPEECH: '.too_long',\n\t\t\t\t\t},\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tprompt: {\n\t\t\t\t\t\t\t...promptAndAsk(\"Hello! You have a selection of one of the following mini games. You can choose between quick maths, riddles or the number memory test. You can also tell me to stop or ask for help at any time. \")\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnlu_process: {\n\t\t\t\t\t\t\tinitial: 'http_timer',\n\t\t\t\t\t\t\tinvoke: {\n\t\t\t\t\t\t\t\tid: \"rasaquery\",\n\t\t\t\t\t\t\t\tsrc: (context, event) => {\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\treturn fetch(new Request(proxyurl + rasaurl, {\n\t\t\t\t\t\t\t        method: 'POST',\n\t\t\t\t\t\t\t        headers: { 'Origin': 'http://localhost:3000/' }, // only required with proxy\n\t\t\t\t\t\t\t        body: `{\"text\": \"${context.recResult}\"}`\n\t\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t        .then(data => data.json());\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonDone: 'completed_query',\n\t\t\t\t\t\t\t\tonError: {\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t\tactions: say(\"Sorry, there was an error. \")\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstates: {\n\t\t\t\t\t\t\t\thttp_timer: {\n\t\t\t\t\t\t\t\t\tentry: send( 'MAX_HTTP', { delay: 12000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tre_prompt: {\n\t\t\t\t\t\t\tentry: say(\"Sorry, I didn't quite get that. Repeat yoself!\"),\n\t\t\t\t\t\t\ton: { ENDSPEECH: 'ask' }\n\t\t\t\t\t\t},\n\t\t\t\t\t\task: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: 7000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t],\n\t\t\t            },\n\t\t\t\t\t\tcompleted_query: {\n\t\t\t\t\t\t\tentry: [\n\t\t\t\t\t\t\t\tassign((context, event)=>{\n\t\t\t\t\t\t\t\t\tconsole.log(event.data.intent.name)\n\t\t\t\t\t\t\t\t\treturn { snippet: ( event.data.intent.name || 'unconfident_resp' ) }\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tsend(\"NLU_REQ_DONE\")\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttoo_long:{\n\t\t\t\t\t\t\tentry: say('Still there?'),\n\t\t\t\t\t\t\ton: { \n\t\t\t\t\t\t\t\tENDSPEECH: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t\tcond: (context) => context.maxspeech_counter > 2,\n\t\t\t\t\t\t\t\t\t\tactions: say(\"As you haven't responded; resetting...\")\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: 'ask',\n\t\t\t\t\t\t\t\t\t\tactions: assign(context=>{ return { maxspeech_counter: (context.maxspeech_counter || 0)+1 } })\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t            }\n\t\t\t\t},\n\t\t\t\tquick_math: {\n\t\t            id: \"quick_math\",\n\t\t\t\t\tinitial: \"generate_math_question\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tMAXSPEECH: '.too_long',\n\t\t\t\t\t\tRECOGNISED: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttarget: '.right_answer',\n\t\t\t\t\t\t\t\tcond: (context) => context.recResult === context.solution.toString(),\n\t\t\t\t\t\t\t\tactions: assign((context)=>{ return { \n\t\t\t\t\t\t\t\t\tpoints: (context.points || 0)+1 ,\n\t\t\t\t\t\t\t\t\twrong_math : 0\n\t\t\t\t\t\t\t\t} })\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttarget: \".wrong_answer\",\n\t\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tgenerate_math_question: {\n\t\t\t\t\t\t\tentry: say(\"Here is your maths question\"),\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tENDSPEECH: {\n\t\t\t\t\t\t\t\t\ttarget: \"ask_math_question\",\n\t\t\t\t\t\t\t\t\tactions: assign((context) => {\n\t\t\t\t\t\t\t\t\t\tvar operator_id = Math.floor(Math.random() * 3)\n\t\t\t\t\t\t\t\t\t\tvar operator = math_operator_store[operator_id].operator\n\t\t\t\t\t\t\t\t\t\treturn { \n\t\t\t\t\t\t\t\t\t\t\tnumber_one: math_operator_store.generate_number(operator),\n\t\t\t\t\t\t\t\t\t\t\tnumber_two: math_operator_store.generate_number(operator),\n\t\t\t\t\t\t\t\t\t\t\toperator_id: operator_id,\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\task_math_question: {\n\t\t\t\t\t\t\tentry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `What is ${context.number_one} ${math_operator_store[context.operator_id].operator} ${context.number_two}.`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: {\n\t\t\t\t\t\t\t\t\ttarget: \"ask\",\n\t\t\t\t\t\t\t\t\tactions: assign(context=> {\n\t\t\t\t\t\t\t\t\t\treturn { solution: math_operator_store.operate(context.number_one, context.number_two, math_operator_store[context.operator_id].operator) }\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\twrong_answer: {\n\t\t\t\t\t\t\tentry: say(\"Sorry, that's wrong!\"),\n\t\t\t\t\t\t\ton: { ENDSPEECH:  [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: 'try_again',\n\t\t\t\t\t\t\t\t\t\tactions: assign(context=>{ return { wrong_math: (context.wrong_math || 0) +1 } }),\n\t\t\t\t\t\t\t\t\t\tcond: context=> (context.wrong_math || 0) < 2,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t\tactions: say(\"... and you've gotten it wrong a couple of times now! Resetting...\"),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tright_answer: {\n\t\t\t\t\t\t\tentry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `Nice, that's right. You have ${context.points} ${( (context.points === 1)? 'point' : 'points')}.`\n\t\t                    })),\n\t\t\t\t\t\t\ton: { \n\t\t\t\t\t\t\t\tENDSPEECH: {\n\t\t\t\t\t\t\t\t\ttarget: \"generate_math_question\",\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttoo_long:{\n\t\t\t\t\t\t\tentry: say('Still there?'),\n\t\t\t\t\t\t\ton: { \n\t\t\t\t\t\t\t\tENDSPEECH: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t\tcond: (context) => context.maxspeech_counter > 2,\n\t\t\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t\t\tassign((context=>{ return { maxspeech_counter: 0 } })),\n\t\t\t\t\t\t\t\t\t\t\tsay(\"As you haven't responded; resetting...\")\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: 'ask',\n\t\t\t\t\t\t\t\t\t\tactions: assign(context=>{ return { maxspeech_counter: (context.maxspeech_counter || 0)+1 } })\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttry_again:{\n\t\t\t\t\t\t\tentry: say(\"Try again.\"),\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tENDSPEECH: 'ask'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\task: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: 7000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t],\n\t\t\t            },\n\t\t\t        }\n\t\t\t\t},\n\t\t\t\triddles: {\n\t\t            id: \"riddles\",\n\t\t\t\t\tinitial: \"prompt\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tMAXSPEECH: '.too_long',\n\t\t\t\t\t\tRECOGNISED: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcond: context => riddles_store[context.riddle_id].answers.includes(context.recResult),\n\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\tassign(context=>{ return { wrong_riddle: 0 } })\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\ttarget: '.another_riddle',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcond: context => context.recResult == ('hint' || 'hint please'),\n\t\t\t                    target: '.hint'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\ttarget: \".wrong_answer\" ,\n\t\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tprompt: {\n\t\t\t\t\t\t\tentry: say(\"Guess the answer to the riddle. Don't be afraid to ask for a hint. Here is your riddle: \"),\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tENDSPEECH: {\n\t\t\t\t\t\t\t\t\ttarget: \"ask_riddle\",\n\t\t\t\t\t\t\t\t\tactions: assign((context) => {\n\t\t\t\t\t\t\t\t\t\treturn { riddle_id: Math.floor(Math.random() * 7) }\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\thint: {\n\t\t\t\t\t\t\tentry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `The hint is:\\n ${riddles_store[context.riddle_id].hint} Now tell me...`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t\t\t\t\t},\n\t\t\t\t\t\task_riddle: {\n\t\t\t\t\t\t\tentry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `${riddles_store[context.riddle_id].riddle}`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: \"ask\" }\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttoo_long:{\n\t\t\t\t\t\t\tentry: say('Hello?'),\n\t\t\t\t\t\t\ton: { \n\t\t\t\t\t\t\t\tENDSPEECH: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t\tactions: say(\"As you haven't responded, resetting...\"),\n\t\t\t\t\t\t\t\t\t\tcond: context=> context.maxspeech_counter >1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: 'ask',\n\t\t\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t\t\tassign(context=>{ return { maxspeech_counter: (context.maxspeech_counter || 0) +1 } }),\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\twrong_answer: {\n\t\t\t\t\t\t\tentry: say(\"Sorry, that's wrong!\"),\n\t\t\t\t\t\t\ton: { ENDSPEECH:  [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: 'try_again',\n\t\t\t\t\t\t\t\t\t\tactions: assign(context=>{ return { wrong_riddle: (context.wrong_riddle || 0) +1 } }),\n\t\t\t\t\t\t\t\t\t\tcond: context=> (context.wrong_riddle || 0) < 2,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t\tactions: say(\"You've gotten it wrong a couple of times now! Resetting...\"),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttry_again:{\n\t\t\t\t\t\t\tentry: say(\"Try again.\"),\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tENDSPEECH: 'ask'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tanother_riddle: {\n\t\t\t\t\t\t\tentry: say(\"Well done, that is correct! Would you like another riddle?\"),\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tRECOGNISED: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: 'prompt',\n\t\t\t\t\t\t\t\t\t\t//actions: assign(context=>{ return { wrong_riddle: (context.wrong_riddle || 0) +1 } }),\n\t\t\t\t\t\t\t\t\t\tcond: context=> (context.recResult || \"invalid\") == \"yes\",\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t\tactions: say(\"Ok, resetting.\"),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\task: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: 15000, id: 'maxspeech_cancel' } )\n\t\t\t\t\t\t\t],\n\t\t\t            },\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tchimp_test: {\n\t\t            id: \"chimp_test\",\n\t\t\t\t\tinitial: \"prompt\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tRECOGNISED: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttarget: '.correct_sequence',\n\t\t\t\t\t\t\t\tactions: assign((context)=>{\n\t\t\t\t\t\t\t\t\tcontext.sequence.push(Math.floor(Math.random() * 9))\n\t\t\t\t\t\t\t\t\treturn { one_try_given: false }\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tcond: context => math_operator_store.parse_asr_numbers(context.recResult) === context.sequence.join('')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\ttarget: \".wrong_sequence\" ,\n\t\t\t\t\t\t\t\tcond: (context) => !commands.includes(context.recResult)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tMAXSPEECH: '.too_long'\n\t\t\t\t\t},\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tprompt: {\n\t\t\t\t\t\t\tentry: say(\"This is the number memory test. I will say an ever increasing sequence of numbers which you need to repeat back to me. If you can't recall a sequence you lose. Try to get the highest score!\"),\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tENDSPEECH: {\n\t\t\t\t\t\t\t\t\ttarget: 'say_sequence',\n\t\t\t\t\t\t\t\t\tactions: assign( (context)=> {\n\t\t\t\t\t\t\t\t\t\treturn { sequence: [Math.floor(Math.random() * 9),] }\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsay_sequence: {\n\t\t\t\t\t\t\tentry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `The ${( (context.sequence.length === 1)? 'first' : 'next')} number is ${context.sequence[context.sequence.length-1]}. Repeat back the sequence`\n\t\t                    })),\n\t\t                    on: { ENDSPEECH: 'ask' }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcorrect_sequence: {\n\t\t\t\t\t\t\tentry: send((context) => ({\n\t\t                        type: \"SPEAK\",\n\t\t                        value: `Good job! You have ${context.sequence.length-1} ${( ( (context.sequence.length-1) === 1)? 'point' : 'points')}.`\n\t\t                    })),\n\t\t\t\t\t\t\ton: { ENDSPEECH: \"say_sequence\" }\n\t\t\t\t\t\t},\n\t\t\t\t\t\twrong_sequence: {\n\t\t\t\t\t\t\tentry: say('That is incorrect. '),\n\t\t\t\t\t\t\ton: { \n\t\t\t\t\t\t\t\tENDSPEECH: [ \n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: 'say_sequence',\n\t\t\t\t\t\t\t\t\t\tcond: context => {return !(context.one_try_given || false)},\n\t\t\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t\t\tassign((context)=>{return { one_try_given: true } }),\n\t\t\t\t\t\t\t\t\t\t\tsay(\"I will give you one more chance to get that right or you lose.\")\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tactions: send((context) => ({\n\t\t\t\t\t                        type: \"SPEAK\",\n\t\t\t\t\t                        value: `You ended with ${context.sequence.length-1} points`\n\t\t\t\t\t                    })),\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\task: {\n\t\t\t                entry: [\n\t\t\t\t\t\t\t\tsend('LISTEN'),\n\t\t\t\t\t\t\t\tsend( 'MAXSPEECH', { delay: context=>(4000+1000*context.sequence.length), id: 'maxspeech_cancel' } ),\n\t\t\t\t\t\t\t],\n\t\t\t            },\n\t\t\t\t\t\ttoo_long:{\n\t\t\t\t\t\t\tentry: say('Hello?'),\n\t\t\t\t\t\t\ton: { \n\t\t\t\t\t\t\t\tENDSPEECH: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\t\t\t\t\tactions: say(\"As you haven't responded, resetting...\"),\n\t\t\t\t\t\t\t\t\t\tcond: context=> context.maxspeech_counter >1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttarget: 'ask',\n\t\t\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t\t\tassign(context=>{ return { maxspeech_counter: (context.maxspeech_counter || 0) +1 } }),\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tplease_repeat: {\n\t\t            id: \"please_repeat\",\n\t\t\t\t\tinitial: \"prompt\",\n\t\t\t\t\tstates: {\n\t\t\t\t\t\tprompt: {\n\t\t\t\t\t\t\tentry: say(\"Sorry, I didn't get that. \")\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\ton: { ENDSPEECH: \"#init\" }\n\t\t\t\t},\n\t\t    },\n\t\t},\n\t\tmaxspeech: {\n\t\t\tinitial: 'apologies',\n\t\t\ton: {\n\t\t\t\tENDSPEECH: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttarget: '#init.main.hist',\n\t\t\t\t\t\tcond: (function() { return maxspeech_count_local < 2 } ),\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t(function() { maxspeech_count_local ++ } ),\n\t\t\t\t\t\t\tassign(context=>{context})\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttarget: '#init',\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t(function() { maxspeech_count_local = 0 } ),\n\t\t\t\t\t\t\tsay(\"and you haven't responded in a while. Resetting.\"),\n\t\t\t\t\t\t\tassign(context=>{context})\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t},\n\t\t\tstates: {\n\t\t\t\tapologies: {\n\t\t\t\t\tentry: say(\"Sorry, I couldn't hear you. \")\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\t\tstop: {\n\t\t\tentry: say(\"Ok, program stopped\"),\n\t\t\ton: {\n\t\t\t\tENDSPEECH: {\n\t\t\t\t\ttarget: '#init'\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\thelp: {\n\t\t\tentry: say(\"Here is a help message, but you made the game, so you shouldn't need one. Going back to the game...\"),\n\t\t\ton: {\n\t\t\t\tENDSPEECH: {\n\t\t\t\t\ttarget: 'main.hist'\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t},\n})\n"]},"metadata":{},"sourceType":"module"}